{"version":3,"file":"c25-vb-about-me.js","sources":["../../src/components/dvag-m-c25-vb-about-me/dvag-m-c25-vb-about-me.ts","../../src/blocks/c25-vb-about-me/c25-vb-about-me.ts"],"sourcesContent":["import { Component, MQBasedRendered, uiElement, uiElements, uiEvent } from \"@kluntje/core\";\nimport { MQ_CHANGE_EVENT, ViewportObserver } from \"@kluntje/services\";\nimport {\n  addClass,\n  find,\n  getCurrentMQ,\n  getParent,\n  onEvent,\n  removeEvent,\n  waitFor,\n} from \"@kluntje/js-utils/lib/dom-helpers\";\nimport { IN_VIEWPORT_EVENT } from \"Constants/eventTypes\";\nimport { IN_VIEWPORT } from \"Constants/cssClasses\";\nimport { DvagBasicOverlay } from \"Components/dvag-m-basic-overlay/dvag-m-basic-overlay\";\nimport mqDefinitions from \"Config/mediaQueries\";\nimport { DVALazyImage } from \"Components/dva-e-lazy-image/dva-e-lazy-image\";\n\n@MQBasedRendered(mqDefinitions)\nexport class DvagC25VbAboutMe extends Component {\n  viewportObserver = ViewportObserver.getInstance();\n\n  @uiElements(\".dvag-m-c25-vb-about-me__gallery-slide\")\n  gallerySlides: Array<HTMLDivElement>;\n\n  @uiElements(\".dvag-m-c25-vb-about-me__gallery-slide .dva-e-lazy-image\")\n  galleryImages: Array<DVALazyImage>;\n\n  @uiElements(\".dvag-m-c25-vb-about-me__gallery-overlay-toggle\")\n  galleryOverlayToggles: Array<HTMLDivElement>;\n\n  @uiElement(\".dvag-m-c25-vb-about-me__gallery-button-counter\")\n  galleryCounter: HTMLSpanElement;\n\n  @uiElement(\".dvag-m-c25-vb-about-me__overlay\")\n  overlay: DvagBasicOverlay;\n\n  afterComponentRender(): void {\n    this.viewportObserver.observe(this);\n    onEvent(this.galleryImages, \"dva-image-loaded\", this.handleLoadedImages, this);\n    this.initGalleryButton();\n  }\n\n  initGalleryButton(): void {\n    if (this.gallerySlides.length < 4) return;\n    this.galleryCounter.innerHTML = `${this.gallerySlides.length}`;\n  }\n\n  handleLoadedImages({ detail }: any): void {\n    const image = detail.target;\n    this.setCaptionWidth(image);\n  }\n\n  setCaptionWidth(image: DVALazyImage): void {\n    const imageWidth = image.offsetWidth;\n    const parentSlide = getParent(image, \".dvag-m-basic-slider__slide\");\n    const text = find(parentSlide, \".dvag-m-basic-slider__slide-text\");\n    if (text === null) return;\n    text.setAttribute(\"style\", `width: ${imageWidth}px;`);\n  }\n\n  @uiEvent(\"galleryOverlayToggles\", \"click\")\n  handleOverlayTogglesClick() {\n    if (getCurrentMQ(mqDefinitions) <= \"MQ3\") return;\n    this.overlay.open();\n  }\n\n  @uiEvent(\"this\", IN_VIEWPORT_EVENT)\n  handleViewportChange() {\n    this.viewportObserver.unobserve(this);\n    removeEvent(this, IN_VIEWPORT_EVENT, this.handleViewportChange, this);\n    waitFor(100).then(() => addClass(this.gallerySlides, IN_VIEWPORT));\n  }\n\n  @uiEvent(\"window\", MQ_CHANGE_EVENT)\n  handleMQChange() {\n    this.galleryImages.forEach((image: DVALazyImage) => {\n      this.setCaptionWidth(image);\n    });\n  }\n}\n\ncustomElements.define(\"dvag-m-c25-vb-about-me\", DvagC25VbAboutMe);\n","import { cleanUpBlock } from \"Utils/cleanUpBlock\";\nimport { html, nothing, render } from \"lit\";\nimport \"./c25-vb-about-me.scss\";\nimport { renderLazyImage } from \"Components/dva-e-lazy-image/dva-e-lazy-image.template\";\nimport { renderIcon } from \"Components/icon/dva-e-icon.template\";\nimport \"Components/dvag-m-c25-vb-about-me/dvag-m-c25-vb-about-me\";\nimport \"Components/dvag-m-basic-slider/dvag-m-basic-slider\";\n\ninterface AboutMeImage {\n  src: string;\n  description: string;\n  aspectRatio: string;\n}\n\ninterface AboutMeTemplateArgs {\n  name?: string;\n  headline?: string;\n  text?: string | null;\n  images?: AboutMeImage[];\n}\n\nconst aboutMeTemplateOverview = (args: AboutMeTemplateArgs) => {\n  return html`\n    <div\n      class=\"c25-vbaboutme dvag-h-margin-top--none\ndvag-h-margin-bottom--none\"\n    >\n      <dvag-m-c25-vb-about-me class=\"dvag-m-c25-vb-about-me dvag-m-skew-component dvag-m-c25-vb-about-me--has-gallery\">\n        <div class=\"dva-h-skew--in\"></div>\n        <div class=\"dvag-m-skewed-box__content\">\n          <div class=\"dvag-m-c25-vb-about-me__grid-wrapper\">\n            <div class=\"dvag-m-c25-vb-about-me__content-wrapper\">\n              <div class=\"dvag-m-section-header\">\n                <h3 class=\"dvag-m-section-header__subheadline\">${args.name}</h3>\n                <h2 class=\"dvag-m-section-header__headline\">${args.headline}</h2>\n              </div>\n              <div class=\"dvag-m-c25-vb-about-me__intro-text dvag-e-richtext\">\n                <p>${args.text}</p>\n              </div>\n\n              <div class=\"dvag-m-c25-vb-about-me__button-wrapper\">\n                <!-- linkType: internalCrossContext -->\n\n                <a class=\"dva-e-button dva-e-button--rebrush \" href=\"/benjamin.rube/ueber-uns.html\">\n                  <div class=\"dva-e-button__background\"></div>\n                  <span class=\"dva-e-button__label\">Mehr über mich erfahren</span>\n                </a>\n              </div>\n            </div>\n\n            <div class=\"dvag-m-c25-vb-about-me__gallery-wrapper\">\n              <dvag-m-basic-slider\n                class=\"dvag-m-basic-slider dvag-m-c25-vb-about-me__slider\"\n                active-on-mq=\"1-3\"\n                title=\"Benjamin Rube - Lernen Sie mich kennen\"\n              >\n                <div class=\"dvag-m-basic-slider__slides dvag-m-c25-vb-about-me__slides\">\n                  ${args.images?.map((image, index) => {\n                    return html`\n                      <div\n                        class=\"dvag-m-basic-slider__slide dvag-m-c25-vb-about-me__gallery-slide dvag-m-c25-vb-about-me__gallery-overlay-toggle\"\n                      >\n                        ${renderLazyImage({\n                          src: image.src,\n                          alt: image.description,\n                          aspectRatio: image.aspectRatio,\n                        })}\n                        ${index === 0\n                          ? html`<div class=\"dvag-m-c25-vb-about-me__gallery-button\">\n                              ${renderIcon(\n                                \"dva-icon-image-gallery-16px\",\n                                \"dvag-m-c25-vb-about-me__gallery-button-icon\",\n                              )}<span class=\"dvag-m-c25-vb-about-me__gallery-button-counter\">3</span> Fotos\n                            </div>`\n                          : nothing}\n\n                        <p class=\"dvag-m-basic-slider__slide-text\">${image.description}</p>\n                      </div>\n                    `;\n                  })}\n                </div>\n\n                <div class=\"dvag-m-basic-slider__controls dvag-m-c25-vb-about-me__controls\">\n                  <button\n                    class=\"dva-e-button dva-e-button--primary dva-e-button--rebrush dvag-m-basic-slider__nav-button dvag-m-basic-slider__nav-button--prev\"\n                  >\n                    <div class=\"dva-e-button__background\"></div>\n                    ${renderIcon(\"dva-icon-chevron-left\")}\n                  </button>\n                  <button\n                    class=\"dva-e-button dva-e-button--primary dva-e-button--rebrush dvag-m-basic-slider__nav-button dvag-m-basic-slider__nav-button--next\"\n                  >\n                    <div class=\"dva-e-button__background\"></div>\n                    ${renderIcon(\"dva-icon-chevron-right\")}\n                  </button>\n                </div>\n\n                <div class=\"dvag-m-basic-slider__grid-container-wrapper dvag-m-c25-vb-about-me__grid-container-wrapper\">\n                  <div class=\"dvag-m-basic-slider__scroll-bar\">\n                    <button class=\"dvag-m-basic-slider__scroll-indicator\" tabindex=\"-1\"></button>\n                  </div>\n                </div>\n              </dvag-m-basic-slider>\n\n              <!-- @BE: this is a duplicate of the button above, due to layout they will visually be toggled in CSS depending on \"--has-gallery\"-modifier -->\n              <div class=\"dvag-m-c25-vb-about-me__button-wrapper\">\n                <!-- linkType: internalCrossContext -->\n\n                <a class=\"dva-e-button dva-e-button--rebrush \" href=\"/benjamin.rube/ueber-uns.html\">\n                  <div class=\"dva-e-button__background\"></div>\n                  <span class=\"dva-e-button__label\">Mehr über mich erfahren</span>\n                </a>\n              </div>\n            </div>\n\n            <dvag-m-basic-overlay\n              class=\"dvag-m-basic-overlay dvag-m-c25-vb-about-me__overlay\"\n              role=\"dialog\"\n              aria-modal=\"true\"\n            >\n              <button type=\"button\" class=\"dva-e-button dvag-m-basic-overlay__close dva-e-button--icon-only\">\n                <div class=\"dva-e-button__background\"></div>\n                ${renderIcon(\"dva-icon-close\", \"dva-e-button__icon\")}\n              </button>\n\n              <div class=\"dvag-m-basic-overlay__content\">\n                <dvag-m-basic-slider\n                  class=\"dvag-m-basic-slider dvag-m-c25-vb-about-me__overlay-slider\"\n                  active-on-mq=\"4-5\"\n                  title=\"Benjamin Rube - Lernen Sie mich kennen\"\n                >\n                  <div class=\"dvag-m-basic-slider__slides dvag-m-c25-vb-about-me__overlay-slides\">\n                    ${args.images?.map(image => {\n                      return html`\n                        <div class=\"dvag-m-basic-slider__slide dvag-m-c25-vb-about-me__overlay-slide\">\n                          ${renderLazyImage({\n                            src: image.src,\n                            alt: image.description,\n                            aspectRatio: image.aspectRatio,\n                          })}\n                          <p class=\"dvag-m-basic-slider__slide-text\">${image.description}</p>\n                        </div>\n                      `;\n                    })}\n                  </div>\n\n                  <div class=\"dvag-m-basic-slider__controls\">\n                    <button\n                      class=\"dva-e-button dva-e-button--primary dva-e-button--rebrush dvag-m-basic-slider__nav-button dvag-m-basic-slider__nav-button--prev\"\n                    >\n                      <div class=\"dva-e-button__background\"></div>\n                      ${renderIcon(\"dva-icon-chevron-left\")}\n                    </button>\n                    <button\n                      class=\"dva-e-button dva-e-button--primary dva-e-button--rebrush dvag-m-basic-slider__nav-button dvag-m-basic-slider__nav-button--next\"\n                    >\n                      <div class=\"dva-e-button__background\"></div>\n                      ${renderIcon(\"dva-icon-chevron-right\")}\n                    </button>\n                  </div>\n\n                  <div class=\"dvag-m-basic-slider__grid-container-wrapper\">\n                    <div class=\"dvag-m-basic-slider__scroll-bar\">\n                      <button class=\"dvag-m-basic-slider__scroll-indicator\" tabindex=\"-1\"></button>\n                    </div>\n                  </div>\n                </dvag-m-basic-slider>\n              </div>\n            </dvag-m-basic-overlay>\n          </div>\n        </div>\n        <div class=\"dva-h-skew--out\"></div>\n      </dvag-m-c25-vb-about-me>\n    </div>\n  `;\n};\n\nexport default function (block: HTMLElement) {\n  const name = block.children[0].textContent || \"\";\n  const headline = block.children[1].textContent || \"\";\n  const text = block.children[2].textContent || \"\";\n\n  const images = [3, 4, 5].map(imageRow => {\n    const imageBlock = block.children[imageRow];\n    const src = imageBlock.children[0].getElementsByTagName(\"img\")[0].src || \"\";\n    const aspectRatio = imageRow === 3 ? \"16:9\" : \"1:1\";\n    const description = imageBlock.children[1].textContent || \"\";\n\n    return { src, description, aspectRatio };\n  });\n\n  cleanUpBlock(block);\n  render(\n    aboutMeTemplateOverview({\n      name,\n      headline,\n      text,\n      images,\n    }),\n    block,\n  );\n}\n"],"names":["DvagC25VbAboutMe","Component","ViewportObserver","onEvent","detail","image","imageWidth","parentSlide","getParent","text","find","getCurrentMQ","mqDefinitions","removeEvent","IN_VIEWPORT_EVENT","waitFor","addClass","IN_VIEWPORT","__decorateClass","uiElements","uiElement","uiEvent","MQ_CHANGE_EVENT","MQBasedRendered","aboutMeTemplateOverview","args","html","_a","index","renderLazyImage","renderIcon","nothing","_b","c25VbAboutMe","block","name","headline","images","imageRow","imageBlock","src","aspectRatio","description","cleanUpBlock","render"],"mappings":"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"}