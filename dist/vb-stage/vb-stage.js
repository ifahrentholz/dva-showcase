import{c as S}from"../__chunks__/cleanUpBlock.VYQGZKWT.js";import{j as y,x as $}from"../__chunks__/lit-element.XkUWx5ik.js";import{U as C,h as R,r as q,p as _,S as x,M as L,R as O}from"../__chunks__/component.module.D5fmAfIh.js";import{l as P,j as h,b as E,a as n,c as g,o as f,r as c,h as b}from"../__chunks__/index.module.BEmWgxQc.js";import{I as N,L as v,c as l}from"../__chunks__/cssClasses.CIN72OsW.js";import{m}from"../__chunks__/mediaQueries.0eOxrCUs.js";import{I as w,M as I}from"../__chunks__/eventTypes.voneREpA.js";import"../__chunks__/dva-m-rating-box.4qyCp2PZ.js";import"../__chunks__/dva-e-lazy-image.UCrOhMiV.js";import"../__chunks__/dva-e-icon.JvN5hF7V.js";import"../__chunks__/getSrcset.ehtWqR_R.js";import"../__chunks__/dva-e-lazy-image.template.ZrSM01wa.js";import"../__chunks__/if-defined.JfW-uEqn.js";import"../__chunks__/dva-e-icon.template.tppk8KWP.js";import"../__chunks__/preload-helper.hlDPvxQM.js";import"../__chunks__/LazyConnectService.yBR27czX.js";const Q=e=>e.fallbackSrc!==void 0&&e.fallbackSrc!=="undefined"?e.fallbackSrc:"",B=e=>{let t="";return e.forEach(i=>{t+=`<video class="dva-e-lazy-video__video dva-js-lazy-video__video"
                      autoplay muted loop playsinline
                      poster="${Q(i)}">`,i.sources.forEach(s=>{const a=s.outerHTML;t+=a}),t+="</video>"}),t},D=e=>`${B(e.sources)}`;var j=Object.defineProperty,z=Object.getOwnPropertyDescriptor,A=(e,t,i,s)=>{for(var a=s>1?void 0:s?z(t,i):t,o=e.length-1,r;o>=0;o--)(r=e[o])&&(a=(s?r(t,i,a):r(a))||a);return s&&a&&j(t,i,a),a};let u=class extends C{constructor(){super({ui:{video:".dva-js-lazy-video__video"},events:[{event:w,target:"this",handler:"handleIntersectionChange"},{event:I,target:"window",handler:"handleMQChange"},{event:"beforeunload",target:"window",handler:"unloadVideo"},{event:"pageshow",target:"window",handler:"handleVideoLoad"}],initialStates:{activeRendition:null},reactions:{activeRendition:["loadVideo"]}}),this.viewportObserver=P.getInstance()}renderingTemplate(){return D({sources:this.sources})}afterComponentRender(){this.viewportObserver.observe(this)}get sources(){if(this.videoSources)return this.videoSources;const e=h(this,"source"),t=new Map;return e.forEach(s=>{let a=s.dataset.dvaMq;if(a===void 0&&(a="1-5"),t.has(a)){const o=t.get(a);o.sources.push(s),t.set(a,o)}else t.set(a,{sources:[s],mqs:this.getMQs(a)})}),h(this,"img").forEach(s=>{let a=s.dataset.dvaMq;a===void 0&&(a="1-5");const o=s.dataset.src;if(t.has(a)&&o!==void 0){const r=t.get(a);r.fallbackSrc=o,t.set(a,r)}}),this.videoSources=t,t}get activeVideo(){const e=parseInt(E(m).slice(2),10),t=[];let i=0;return this.sources.forEach(s=>{R(s.mqs,e)&&t.push(i),i+=1}),t.length?t[0]:0}handleIntersectionChange(){this.viewportObserver.unobserve(this),n(this,N),g(this,w,this.handleIntersectionChange,this),this.setState({activeRendition:this.activeVideo})}handleMQChange(){this.setState({activeRendition:this.activeVideo})}handleVideoLoad(e){g(e.target,"loadeddata",this.handleVideoLoad,this),n(this,v),n(this,l),n(this.ui.video[this.state.activeRendition],v)}handleVideoLoadingError(e){g(e.target,"error",this.handleVideoLoadingError,this);const t=this.ui.video[this.state.activeRendition];n(this,v),n(this,l),n(t,v)}loadVideo(){if(this.ui.video.length<=this.state.activeRendition)return;this.unloadVideo();const e=this.ui.video[this.state.activeRendition],t=h(e,"source");f(e,"loadeddata",this.handleVideoLoad,this),f(t[t.length-1],"error",this.handleVideoLoadingError,this),t.forEach(i=>{const s=i.dataset.src;s!==void 0&&i.setAttribute("src",s)}),e.load()}unloadVideo(){c(this.ui.video,v),c(this,v),c(this,l)}getMQs(e){let t=[];return q(e).split(",").forEach(i=>{if(i.length===1)t=_(t,parseInt(i,10));else if(i.length>1){const s=i.split("-"),a=parseInt(s[0],10),o=parseInt(s[1],10);for(let r=a;r<=o;r++)t=_(t,r)}}),t}};u=A([x(m)],u);customElements.define("dva-e-lazy-video",u);var T=Object.defineProperty,H=Object.getOwnPropertyDescriptor,M=(e,t,i,s)=>{for(var a=s>1?void 0:s?H(t,i):t,o=e.length-1,r;o>=0;o--)(r=e[o])&&(a=(s?r(t,i,a):r(a))||a);return s&&a&&T(t,i,a),a};class p extends C{afterComponentRender(){this.checkButtonModifier(),this.setButtonClass()}checkButtonModifier(){b(this,"dvag-m-c04-vb-stage--no-vb-image")&&n(this.stageCta,"dva-e-button--white")}setButtonClass(){if(b(this,"dvag-m-c04-vb-stage--no-vb-image"))return;const t=E(m);t==="MQ4"||t==="MQ5"?n(this.stageCta,"dva-e-button--white"):c(this.stageCta,"dva-e-button--white")}}M([L(".dvag-m-c04-vb-stage__cta")],p.prototype,"stageCta",2);M([O("window",I)],p.prototype,"setButtonClass",1);customElements.define("dvag-m-c04-vb-stage",p);const V=e=>`${window.hlx.codeBasePath}/dist/video/${e}`,U=({description:e,picture:t,name:i,rating:s,titel:a,videoFallback:o,videoName:r})=>(t==null||t.classList.add("dvag-m-c04-vb-stage__vb-portrait"),$`<div class="c04-vbstage dvag-h-margin-bottom--none"><dvag-m-c04-vb-stage class="dvag-m-c04-vb-stage" id="c04-vb-stage"><div class="dvag-m-c04-vb-stage__background-wrapper"><dva-e-lazy-video class="dva-e-lazy-video dva-h-preload dva-h-preload__4-3--mq-1-3 dva-h-preload__21-9--mq-4-and-up dvag-m-c04-vb-stage__background-video"><source data-src="${V(r)}.754.564.mp4" type="dist/video/mp4" data-dva-mq="4-5"><img data-src="${o==null?void 0:o.src}" alt="${o==null?void 0:o.alt}"><source data-src="${V(r)}.1200.500.mp4" type="dist/video/mp4" data-dva-mq="1-3"><img data-src="${o==null?void 0:o.src}" alt="${o==null?void 0:o.alt}"></dva-e-lazy-video><div class="dvag-m-c04-vb-stage__skewed-box"><div class="dva-h-skew--in"></div><div class="dva-m-skewed-box__content"></div><div class="dva-h-skew--out"></div></div></div><div class="dvag-m-c04-vb-stage__content-wrapper"><div class="dvag-m-c04-vb-stage__vb-image"><div class="dvag-m-c04-vb-stage__vb-image-wrapper">${t}</div></div><div class="dvag-m-c04-vb-stage__vb-content"><div class="dvag-m-c04-vb-stage__vb-inner-content"><div class="dvag-m-c04-vb-stage__rating-wrapper"><dva-m-rating-box class="dva-m-rating-box" rating="${s}"></dva-m-rating-box><p class="dvag-m-c04-vb-stage__rating-label">5 von 5 Sternen<a class="dvag-m-c04-vb-stage__rating-link" href="#">15 Bewertungen</a></p></div><p class="dvag-m-c04-vb-stage__vb-name">${i}</p><p class="dvag-m-c04-vb-stage__vb-info">${e}</p><p class="dvag-m-c04-vb-stage__vb-title">${a}</p><dvag-e-c26-vb-contact-overlay-toggle class="dvag-e-c26-vb-contact-overlay-toggle dva-e-button dva-e-button--rebrush dva-e-button--small dvag-m-c04-vb-stage__cta dva-e-button--white" id="contact_c04-vb-stage" no-cookie-hide="no-cookie-hide"><div class="dva-e-button__background"></div><span class="dva-e-button__label">Kontakt aufnehmen</span><dva-e-icon class="dva-e-button__icon" icon-id="dva-icon-contact-new"></dva-e-icon></dvag-e-c26-vb-contact-overlay-toggle></div></div></div></dvag-m-c04-vb-stage></div>`),d=(e,t)=>{var s;return((s=e.children[t].textContent)==null?void 0:s.trim())??""},W=(e,t)=>parseInt(d(e,t),10)||0,G=(e,t)=>parseFloat(d(e,t))||0,K=(e,t)=>{const i=G(e,t),s=Math.min(Math.max(i,.5),5);return Math.round(s*2)/2};function ct(e){var s;const t={picture:e.children[0].querySelector("picture")??void 0,videoFallback:e.children[1].querySelector("img")??void 0,videoName:d(e,2),name:d(e,3),description:d(e,4),titel:d(e,5),rating:K(e,6),shared:W(e,7),buttonLabel:d(e,8)},i=((s=t.picture)==null?void 0:s.querySelector("img"))??void 0;i==null||i.setAttribute("loading","eager"),i==null||i.setAttribute("fetchpriority","high"),S(e),y(U(t),e)}export{ct as default};
//# sourceMappingURL=vb-stage.js.map
