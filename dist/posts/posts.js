import{j as d,x as i,a as o}from"../__chunks__/lit-element.f0zsYA8R.js";import{i as h}from"../__chunks__/if-defined.v6SUrrOf.js";import{c as y}from"../__chunks__/createOptimizedPicture.lBh_4LJd.js";import{F as u}from"../__chunks__/fetch.service.MWvor5vW.js";import{i as P}from"../__chunks__/isSidekickLibraryActive.iN4ARc8o.js";import"../__chunks__/lit-html.vGJGB7fL.js";const $=t=>t?i`<h3>${t}</h3>`:o,x=t=>t?t.length>200?i`<p>${t.slice(0,200)}...</p>`:i`<p>${t}</p>`:o,g=(t,e)=>e?i`<a href="${h(t)}" class="image">${e}</a>`:o,w=t=>{const{postUrl:e,headline:a,text:r,picture:p,buttontext:c}=t;return i`<article>${g(e,p)} ${$(a)} ${x(r)}<ul class="actions"><li><a href="${h(e)}" class="button">${c||"Goto Post"}</a></li></ul></article>`},T=t=>t.map(e=>w(e)),v=t=>{var a;return(a=Array.from(t.querySelectorAll("p")).find(r=>r.innerText.trim().length>0))==null?void 0:a.innerText};async function M(t){t.innerHTML="";const e=new DOMParser,r=(await u.fetchJson("/query-index.json")).data.filter(s=>s.path.startsWith("/posts")),f=(await Promise.all(r.map(s=>u.fetchText(`${s.path}.plain.html`,{cacheOptions:{cacheType:"runtime"}})))).map(s=>e.parseFromString(s,"text/html")).map((s,n)=>{var l,m;return{postUrl:P()?void 0:`${window.hlx.codeBasePath}${r[n].path}`,headline:((l=s.querySelector("h1"))==null?void 0:l.innerText)||((m=s.querySelector("h2"))==null?void 0:m.innerText),text:v(s),buttontext:r[n].buttontext,picture:y({src:r[n].image,alt:r[n].imagealt,width:323,height:199})}});t.style.removeProperty("display"),d(T(f),t)}export{M as default};
//# sourceMappingURL=posts.js.map
