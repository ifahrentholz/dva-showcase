{"version":3,"mappings":"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","names":["truncateText","text","maxLength","DvagC01eTeaser","Component","_a","dateAsInt","date","intervals","seconds","interval","i","count","label","e","__decorateClass","uiElement","uiEvent","DvagC07RatingTeaserSlider","detail","overlayTeaser","nextOverlayTeaser","uiElements","DvagC01eTeaserOverlay","DvagBasicOverlay","ratingOverlayTemplate","render","__vitePreload","args","hasClass","ACTIVE","removeClass","ANIMATING","waitFor","ratingTeaserSlideTemplate","html","ratingTeaserSliderTemplate","unsafeHTML","slide","getSlidesTemplateArgs","slides","sliderId","index","ratingTeaserSlider","block","uuidv4","subheadline","headline","slidesEndpoint","fetchService","cta","ctaLabel","ctaUrl","cleanUpBlock","error","DebuggerService"],"sources":["../../src/utils/truncateText.ts","../../src/components/dvag-m-c01e-teaser/dvag-m-c01e-teaser.ts","../../src/components/dvag-m-c07-rating-teaser-slider/dvag-m-c07-rating-teaser-slider.ts","../../src/components/dvag-m-c01e-teaser-overlay/dvag-m-c01e-teaser-overlay.ts","../../src/blocks/rating-teaser-slider/rating-teaser-slider.ts"],"sourcesContent":["export const truncateText = (text: string, maxLength: number): string => {\n  if (text.length <= maxLength) return text;\n  return `${text.slice(0, maxLength)}...`;\n};\n","import { Component, uiElement, uiEvent } from \"@kluntje/core\";\nimport { DvaRatingBox } from \"Components/dva-m-rating-box/dva-m-rating-box\";\n\nexport type RatingTeaserData = {\n  vbImg: string;\n  vbName: string;\n  vbHomepage: string;\n  vbLocation: string;\n  mainRating: string;\n  date: string;\n  headline: string;\n  text: string;\n  customerName: string;\n  customerInfo: string;\n  ratings: {\n    consulting: string;\n    satisfaction: string;\n    service: string;\n  };\n  hasPrevTeaser: boolean;\n  hasNextTeaser: boolean;\n};\n\nexport class DvagC01eTeaser extends Component {\n  @uiElement(\".dvag-m-c01e-teaser__cta\")\n  overlayCta: HTMLAnchorElement;\n\n  @uiElement(\".dva-m-rating-box\")\n  ratingBox: DvaRatingBox;\n\n  @uiElement(\".dvag-m-c01e-teaser__rating-date\")\n  ratingDate: HTMLSpanElement;\n\n  @uiElement(\".dvag-m-c01e-teaser__headline\")\n  ratingHeadline: HTMLHeadingElement;\n\n  @uiElement(\".dvag-m-c01e-teaser__full-text\")\n  text: HTMLParagraphElement;\n\n  @uiElement(\".dvag-m-c01e-teaser__customer-name\")\n  customerDisplayName: HTMLParagraphElement;\n\n  @uiElement(\".dvag-m-c01e-teaser__customer-information\")\n  customerInformation: HTMLSpanElement;\n\n  @uiElement(\".dvag-m-c01e-teaser__rating-date\")\n  createdDate: HTMLSpanElement;\n\n  /**\n   * Returns main rating of teaser\n   * @returns {string}\n   */\n  get mainRating(): string {\n    return this.ratingBox.rating.toString();\n  }\n\n  /**\n   * Returns date of rating\n   * @returns {string}\n   */\n  get date(): string {\n    return (this.ratingDate.innerText || \"\").trim();\n  }\n\n  /**\n   * Returns headline of rating\n   * @returns {string}\n   */\n  get headline(): string {\n    return (this.ratingHeadline.innerText || \"\").trim();\n  }\n\n  /**\n   * Returns ful text of rating\n   * @returns {string}\n   */\n  get fullText(): string {\n    return (this.text.innerText || \"\").trim();\n  }\n\n  /**\n   * Returns customer info text of rating\n   * @returns {string}\n   */\n  get customerInfo(): string {\n    return (this.customerInformation.innerText || \"\").trim();\n  }\n\n  /**\n   * Returns customer name text of rating\n   * @returns {string}\n   */\n  get customerName(): string {\n    return (this.customerDisplayName.innerText || \"\").trim();\n  }\n\n  /**\n   * Returns given consulting-rating\n   * @returns {string}\n   */\n  get consultingRating(): string {\n    return (this.getAttribute(\"consulting-rating\") || \"0\").trim();\n  }\n\n  /**\n   * Returns given satisfaction-rating\n   * @returns {string}\n   */\n  get satisfactionRating(): string {\n    return (this.getAttribute(\"satisfaction-rating\") || \"0\").trim();\n  }\n\n  /**\n   * Returns given service-rating\n   * @returns {string}\n   */\n  get serviceRating(): string {\n    return (this.getAttribute(\"service-rating\") || \"0\").trim();\n  }\n\n  /**\n   * Returns given vb-name\n   * @returns {string}\n   */\n  get vbName(): string {\n    return (this.getAttribute(\"vb-name\") || \"0\").trim();\n  }\n\n  /**\n   * Returns given vb-image-url\n   * @returns {string}\n   */\n  get vbImage(): string {\n    return (this.getAttribute(\"vb-image-url\") || \"0\").trim();\n  }\n\n  /**\n   * Returns given vb-homepage-url\n   * @returns {string}\n   */\n  get vbHomepage(): string {\n    return (this.getAttribute(\"vb-homepage-url\") || \"0\").trim();\n  }\n\n  /**\n   * Returns given vb-location\n   * @returns {string}\n   */\n  get vbLocation(): string {\n    return (this.getAttribute(\"vb-location\") || \"0\").trim();\n  }\n\n  /**\n   * Returns given teaser-index\n   * @returns {number}\n   */\n  get teaserIdx(): number {\n    return parseInt(this.getAttribute(\"teaser-index\") || \"0\", 10);\n  }\n\n  /**\n   * Tells, whether this teaser is not\n   * the first teaser in the container\n   * @returns {boolean}\n   */\n  get hasPrevTeaser(): boolean {\n    return this.parentElement?.previousElementSibling !== null;\n  }\n\n  /**\n   * Tells, whether this teaser is not\n   * the first teaser in the container\n   * @returns {boolean}\n   */\n  get hasNextTeaser(): boolean {\n    return this.parentElement?.nextElementSibling !== null;\n  }\n\n  /**\n   * Returns all information needed for the overlay\n   * @returns {RatingTeaserData}\n   */\n  get teaserData(): RatingTeaserData {\n    return {\n      vbImg: this.vbImage,\n      vbName: this.vbName,\n      vbHomepage: this.vbHomepage,\n      vbLocation: this.vbLocation,\n      mainRating: this.mainRating,\n      date: this.date,\n      headline: this.headline,\n      text: this.fullText,\n      customerName: this.customerName,\n      customerInfo: this.customerInfo,\n      ratings: {\n        consulting: this.consultingRating,\n        satisfaction: this.satisfactionRating,\n        service: this.serviceRating,\n      },\n      hasPrevTeaser: this.hasPrevTeaser,\n      hasNextTeaser: this.hasNextTeaser,\n    };\n  }\n\n  afterComponentRender(): void {\n    this.convertDate();\n  }\n\n  convertDate(): void {\n    const dateAsInt = parseInt(this.createdDate.getAttribute(\"date\") || \"0\", 10);\n    const date = new Date(dateAsInt);\n\n    const intervals = [\n      { label: \"Jahr\", labelPlural: \"Jahren\", seconds: 3600 * 24 * 365 },\n      { label: \"Monat\", labelPlural: \"Monaten\", seconds: 3600 * 24 * 30 },\n      { label: \"Woche\", labelPlural: \"Wochen\", seconds: 3600 * 24 * 7 },\n      { label: \"Tag\", labelPlural: \"Tagen\", seconds: 3600 * 24 },\n      { label: \"Stunde\", labelPlural: \"Stunden\", seconds: 3600 },\n      { label: \"Minute\", labelPlural: \"Minuten\", seconds: 60 },\n      { label: \"Sekunde\", labelPlural: \"Sekunden\", seconds: 1 },\n    ];\n\n    const seconds = Math.floor((Date.now() - date.getTime()) / 1000);\n    const interval = intervals.find(i => i.seconds < seconds);\n    if (interval !== undefined) {\n      const count = Math.floor(seconds / interval.seconds);\n      const label = count > 1 ? interval.labelPlural : interval.label;\n      this.createdDate.innerHTML = `vor ${count} ${label}`;\n    } else {\n      this.createdDate.innerHTML = `${date.toLocaleDateString(\"de-DE\")}`;\n    }\n  }\n\n  /**\n   * Handles CTA-click, by dispatching 'dva-open-overlay' event\n   * @param {Event} e\n   */\n  @uiEvent(\"overlayCta\", \"click\")\n  openOverlay(e: any) {\n    e.preventDefault();\n    this.dispatchEvent(\n      new CustomEvent(\"dva-open-overlay\", {\n        detail: {\n          target: this,\n          data: this.teaserData,\n          teaserIdx: this.teaserIdx,\n        },\n      }),\n    );\n  }\n}\n\ncustomElements.define(\"dvag-m-c01e-teaser\", DvagC01eTeaser);\n","import { Component, uiElement, uiElements, uiEvent } from \"@kluntje/core\";\nimport { DvagC01eTeaserOverlay } from \"Components/dvag-m-c01e-teaser-overlay/dvag-m-c01e-teaser-overlay\";\nimport { DvagC01eTeaser } from \"Components/dvag-m-c01e-teaser/dvag-m-c01e-teaser\";\n\nexport class DvagC07RatingTeaserSlider extends Component {\n  @uiElements(\".dvag-m-c01e-teaser\")\n  teasers: Array<DvagC01eTeaser>;\n\n  @uiElement(\".dvag-m-c01e-teaser-overlay\")\n  overlay: DvagC01eTeaserOverlay;\n\n  constructor() {\n    super({\n      initialStates: {\n        overlayTeaser: -1,\n      },\n      reactions: {\n        overlayTeaser: [\"renderOverlay\"],\n      },\n    });\n  }\n\n  /**\n   * returns the index of the last available teaser\n   * @returns {number}\n   */\n  get lastTeaser(): number {\n    return this.teasers.length - 1;\n  }\n\n  /**\n   * Triggers Overlay Rendering, by setting overlayTeaser-state\n   */\n  @uiEvent(\"teasers\", \"dva-open-overlay\")\n  openOverlay({ detail }: any): void {\n    this.setState({ overlayTeaser: detail.teaserIdx });\n  }\n\n  /**\n   * renders Overlay with needed data of given teaser\n   */\n  renderOverlay({ overlayTeaser }: any): void {\n    if (overlayTeaser < -1) {\n      this.setState({ overlayTeaser: -1 }, { silent: true });\n      return;\n    }\n\n    if (overlayTeaser === -1) return;\n\n    if (overlayTeaser > this.lastTeaser) {\n      this.setState({ overlayTeaser: this.lastTeaser }, { silent: true });\n      return;\n    }\n\n    this.overlay.setState({ args: this.teasers[overlayTeaser].teaserData });\n  }\n\n  /**\n   * Handles Overlay Navigation event, by setting overlayTeaser-state\n   */\n  @uiEvent(\"overlay\", \"dvag-m-c01e-teaser-overlay-nav\")\n  handleOverlayNav({ detail }: any): void {\n    if (detail.direction === \"prev\" && this.state.overlayTeaser === 0) return;\n\n    let nextOverlayTeaser = this.state.overlayTeaser + 1;\n    if (detail.direction === \"prev\") nextOverlayTeaser -= 2;\n\n    this.setState({ overlayTeaser: nextOverlayTeaser });\n  }\n\n  /**\n   * Handles Overly closing event, by resetting overlayTeaser-state\n   * to its initial value\n   */\n  @uiEvent(\"overlay\", \"dva-overlay-closed\")\n  handleOverlayClosed(): void {\n    this.setState({ overlayTeaser: -1 });\n  }\n}\n\ncustomElements.define(\"dvag-m-c07-rating-teaser-slider\", DvagC07RatingTeaserSlider);\n","import { render, TemplateResult } from \"lit-html\";\nimport { uiElement, uiEvent } from \"@kluntje/core\";\nimport { hasClass, removeClass, waitFor } from \"@kluntje/js-utils/lib/dom-helpers\";\nimport { ACTIVE, ANIMATING } from \"Constants/cssClasses\";\nimport { RatingTeaserData } from \"Components/dvag-m-c01e-teaser/dvag-m-c01e-teaser\";\nimport { DvagBasicOverlay } from \"Components/dvag-m-basic-overlay/dvag-m-basic-overlay\";\n\nexport class DvagC01eTeaserOverlay extends DvagBasicOverlay {\n  @uiElement(\".dvag-m-c01e-teaser-overlay__nav-btn--prev\")\n  prevBtn: HTMLAnchorElement;\n\n  @uiElement(\".dvag-m-c01e-teaser-overlay__nav-btn--next\")\n  nextBtn: HTMLAnchorElement;\n\n  constructor() {\n    super({\n      initialStates: {\n        args: null,\n      },\n      reactions: {\n        args: [\"openOverlay\"],\n      },\n      asyncRendering: true,\n    });\n  }\n\n  /**\n   * default overlayArgs needed for initial render\n   * @returns {RatingTeaserData}\n   */\n  get defaultArgs(): RatingTeaserData {\n    return {\n      vbImg: \"\",\n      vbName: \"\",\n      vbHomepage: \"\",\n      vbLocation: \"\",\n      mainRating: \"0\",\n      date: \"\",\n      headline: \"\",\n      text: \"\",\n      customerName: \"\",\n      customerInfo: \"\",\n      ratings: {\n        consulting: \"0\",\n        satisfaction: \"0\",\n        service: \"0\",\n      },\n      hasPrevTeaser: false,\n      hasNextTeaser: false,\n    };\n  }\n\n  /**\n   * override renderAsync method of parent\n   * initially render overlay to add needed event to ui elements\n   * @override\n   */\n  async renderAsync() {\n    try {\n      const ratingOverlayTemplate = await this.loadTemplate();\n      render(ratingOverlayTemplate(this.defaultArgs), this);\n    } catch (e) {\n      console.error(\"Overlay:\", e);\n    }\n  }\n\n  async loadTemplate(): Promise<(args: RatingTeaserData) => TemplateResult> {\n    const { ratingOverlayTemplate } = await import(\"./dvag-m-c01e-teaser-overlay.template\");\n    return ratingOverlayTemplate;\n  }\n\n  /**\n   * renders overlay with given args and opens it by adding ACTIVE Class to it\n   */\n  async openOverlay({ args }: any): Promise<void> {\n    if (args === null) return;\n    const ratingOverlayTemplate = await this.loadTemplate();\n    render(ratingOverlayTemplate(args), this);\n    if (hasClass(this, ACTIVE)) return;\n    super.open();\n  }\n\n  /**\n   * closes Overlay by removing ACTIVE Class from it,\n   * additionally resets overlayArgs to null\n   * @override\n   */\n  async close() {\n    this.setState({ args: null });\n    removeClass(this, ANIMATING);\n    await waitFor(300);\n    removeClass(this, ACTIVE);\n    this.dispatchEvent(\n      new CustomEvent(\"dva-overlay-closed\", {\n        detail: {\n          target: this,\n        },\n      }),\n    );\n    super.close();\n  }\n\n  /**\n   * Handles prev-btn click event, by dispatching navigation event\n   */\n  @uiEvent(\"prevBtn\", \"click\")\n  loadPrevTeaser() {\n    this.dispatchEvent(\n      new CustomEvent(\"dvag-m-c01e-teaser-overlay-nav\", {\n        detail: {\n          target: this,\n          direction: \"prev\",\n        },\n      }),\n    );\n  }\n\n  /**\n   * Handles next-btn click event, by dispatching navigation event\n   */\n  @uiEvent(\"nextBtn\", \"click\")\n  loadNextTeaser(): void {\n    this.dispatchEvent(\n      new CustomEvent(\"dvag-m-c01e-teaser-overlay-nav\", {\n        detail: {\n          target: this,\n          direction: \"next\",\n        },\n      }),\n    );\n  }\n\n  /**\n   * Adds KeyboardEvent-reactions for arrow keys\n   * @override\n   */\n  handleKeyup(e: KeyboardEvent): void {\n    switch (e.key) {\n      case \"Escape\":\n        this.close();\n        break;\n      case \"ArrowRight\":\n        if (hasClass(this, ACTIVE)) {\n          this.loadNextTeaser();\n        }\n        break;\n      case \"ArrowLeft\":\n        if (hasClass(this, ACTIVE)) {\n          this.loadPrevTeaser();\n        }\n        break;\n    }\n  }\n}\n\ncustomElements.define(\"dvag-m-c01e-teaser-overlay\", DvagC01eTeaserOverlay);\n","import { truncateText } from \"Utils/truncateText\";\nimport { html, render } from \"lit\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { unsafeHTML } from \"lit-html/directives/unsafe-html.js\";\nimport fetchService from \"Services/fetch.service\";\nimport \"./rating-teaser-slider.scss\";\nimport \"Components/dvag-m-c01e-teaser/dvag-m-c01e-teaser\";\nimport \"Components/dva-m-rating-box/dva-m-rating-box\";\nimport \"Components/dvag-m-c07-rating-teaser-slider/dvag-m-c07-rating-teaser-slider\";\nimport \"Components/dvag-m-basic-slider/dvag-m-basic-slider\";\nimport \"Components/dvag-m-c01e-teaser-overlay/dvag-m-c01e-teaser-overlay\";\nimport { DebuggerService } from \"@kluntje/services\";\nimport { cleanUpBlock } from \"Utils/cleanUpBlock\";\n\ninterface RatingTeaserSliderTemplateArgs {\n  sliderId: string;\n  subheadline: string;\n  headline: string;\n  text: string;\n  slides: RatingTeaserSlideTemplateArgs[];\n  ctaLabel: string;\n  ctaUrl: string;\n}\n\ninterface RatingTeaserSlideTemplateArgs {\n  sliderId: string;\n  slideIndex: number;\n  slidesLength: number;\n  consultingRating: string;\n  satisfactionRating: string;\n  serviceRating: string;\n  rating: string;\n  vbName: string;\n  vbImageUrl: string;\n  vbHomepageUrl: string;\n  vbLocation: string;\n  headline: string;\n  text: string;\n  reviewFrom: string;\n  reviewerCustomerSince: string;\n  ratingDate: string;\n}\n\nconst ratingTeaserSlideTemplate = (args: RatingTeaserSlideTemplateArgs) => {\n  return html`\n    <div\n      id=\"c07-ratingteaserslider-${args.sliderId}-slide-${args.slideIndex + 1}\"\n      class=\"dvag-m-basic-slider__slide\"\n      aria-roledescription=\"slide\"\n      aria-label=${`Slide ${args.slideIndex + 1} of ${args.slidesLength}`}\n    >\n      <dvag-m-c01e-teaser\n        class=\"dvag-m-c01e-teaser\"\n        teaser-index=\"${args.slideIndex}\"\n        consulting-rating=\"${args.consultingRating}\"\n        satisfaction-rating=\"${args.satisfactionRating}\"\n        service-rating=\"${args.serviceRating}\"\n        vb-name=\"${args.vbName}\"\n        vb-image-url=\"${args.vbImageUrl}\"\n        vb-homepage-url=\"${args.vbHomepageUrl}\"\n        vb-location=\"${args.vbLocation}\"\n      >\n        <div class=\"dvag-m-c01e-teaser__content\">\n          <div class=\"dvag-m-c01e-teaser__rating-wrapper\">\n            <dva-m-rating-box\n              class=\"dva-m-rating-box dvag-m-c01e-teaser__main-rating\"\n              rating=\"${args.rating}\"\n            ></dva-m-rating-box>\n            <p class=\"dvag-m-c01e-teaser__rating-label\">${args.rating} von 5 Sternen</p>\n          </div>\n\n          <h3 class=\"dvag-m-c01e-teaser__headline\">${args.headline}</h3>\n          <p class=\"dvag-m-c01e-teaser__text\">${truncateText(args.text, 157)}</p>\n          <p class=\"dvag-m-c01e-teaser__full-text\">${args.text}</p>\n\n          <a href=\"#\" class=\"dva-e-link dvag-m-c01e-teaser__cta\">\n            <span class=\"dva-e-link__label\">Mehr erfahren</span>\n            <dva-e-icon class=\"dva-e-icon\" icon-id=\"dva-icon-arrow-right-48px\"></dva-e-icon>\n          </a>\n        </div>\n        <div class=\"dvag-m-c01e-teaser__footer\">\n          <h4 class=\"dvag-m-c01e-teaser__customer-label\">Bewertet von:</h4>\n          <p class=\"dvag-m-c01e-teaser__customer-name\">${args.reviewFrom}</p>\n          <p class=\"dvag-m-c01e-teaser__customer-info\">\n            <span class=\"dvag-m-c01e-teaser__rating-date\" date=\"${args.ratingDate}\">${args.ratingDate}</span>,\n            <span class=\"dvag-m-c01e-teaser__customer-information\">Kunde seit ${args.reviewerCustomerSince}</span>\n          </p>\n        </div>\n      </dvag-m-c01e-teaser>\n    </div>\n  `;\n};\n\nconst ratingTeaserSliderTemplate = (args: RatingTeaserSliderTemplateArgs) => {\n  return html`\n    <div\n      class=\"c07-ratingteaserslider carousel dvag-h-margin-bottom--none\ndvag-h-margin-top--none\ndvag-h-background--grey\ndvag-h-skew--top\"\n    >\n      <dvag-m-c07-rating-teaser-slider\n        class=\"dvag-m-c07-rating-teaser-slider dvag-m-skew-component cmp-carousel  \"\n        id=\"c07-ratingteaserslider-${args.sliderId}\"\n        role=\"group\"\n        data-cmp-is=\"carousel\"\n      >\n        <div class=\"dva-h-skew--in\"></div>\n\n        <div class=\"dvag-m-skewed-box__content\">\n          <div class=\"dvag-m-c07-rating-teaser-slider__grid-wrapper\">\n            <div class=\"dvag-m-section-header\">\n              <h3 class=\"dvag-m-section-header__subheadline\">${args.subheadline}</h3>\n              <h2 class=\"dvag-m-section-header__headline\">${args.headline}</h2>\n              <div class=\"dvag-m-section-header__text dvag-e-richtext\">${unsafeHTML(args.text)}</div>\n            </div>\n          </div>\n\n          <dvag-m-basic-slider\n            class=\"dvag-m-basic-slider dvag-m-teaser-slider cmp-carousel\"\n            title=\"Das sagen meine Kunden\"\n            id=\"c07-ratingteaserslider-${args.sliderId}-slider\"\n            role=\"group\"\n            aria-live=\"polite\"\n            aria-roledescription=\"carousel\"\n            data-cmp-is=\"carousel\"\n          >\n            <div class=\"dvag-m-basic-slider__slides\">${args.slides.map(slide => ratingTeaserSlideTemplate(slide))}</div>\n\n            <div class=\"dvag-m-basic-slider__controls\">\n              <button\n                class=\"dva-e-button dva-e-button--primary dva-e-button--rebrush dvag-m-basic-slider__nav-button dvag-m-basic-slider__nav-button--prev\"\n              >\n                <div class=\"dva-e-button__background\"></div>\n                <dva-e-icon class=\"dva-e-icon\" icon-id=\"dva-icon-chevron-left\"></dva-e-icon>\n              </button>\n              <button\n                class=\"dva-e-button dva-e-button--primary dva-e-button--rebrush dvag-m-basic-slider__nav-button dvag-m-basic-slider__nav-button--next dva-state-visible\"\n              >\n                <div class=\"dva-e-button__background\"></div>\n                <dva-e-icon class=\"dva-e-icon\" icon-id=\"dva-icon-chevron-right\"></dva-e-icon>\n              </button>\n            </div>\n\n            <div class=\"dvag-m-basic-slider__grid-container-wrapper\">\n              <div class=\"dvag-m-basic-slider__scroll-bar\">\n                <button\n                  class=\"dvag-m-basic-slider__scroll-indicator\"\n                  tabindex=\"-1\"\n                  style=\"width: 19.9077%; transform: translateX(0%);\"\n                ></button>\n              </div>\n            </div>\n          </dvag-m-basic-slider>\n\n          <dvag-m-c01e-teaser-overlay class=\"dvag-m-c01e-teaser-overlay\"></dvag-m-c01e-teaser-overlay>\n\n          <div class=\"dvag-m-c07-rating-teaser-slider__grid-wrapper\">\n            <div class=\"dvag-m-c07-rating-teaser-slider__button-wrapper\">\n              <!-- linkType: internalCrossContext -->\n              <a class=\"dva-e-button dva-e-button--rebrush \" href=\"${args.ctaUrl}\">\n                <div class=\"dva-e-button__background\"></div>\n                <span class=\"dva-e-button__label\">${args.ctaLabel}</span>\n              </a>\n              <!-- linkType: internal -->\n            </div>\n          </div>\n        </div>\n\n        <div class=\"dva-h-skew--out\"></div>\n      </dvag-m-c07-rating-teaser-slider>\n    </div>\n  `;\n};\n\nexport interface SlidesJsonResponse {\n  total: number;\n  offset: number;\n  limit: number;\n  data: SlidesJsonResponseItem[];\n  \":type\": string;\n}\n\nexport interface SlidesJsonResponseItem {\n  consultingRating: string;\n  satisfactionRating: string;\n  serviceRating: string;\n  rating: string;\n  vbName: string;\n  vbImageUrl: string;\n  vbHomepageUrl: string;\n  vbLocation: string;\n  headline: string;\n  text: string;\n  reviewFrom: string;\n  reviewerCustomerSince: string;\n  ratingDate: string;\n}\n\nconst getSlidesTemplateArgs = (slides: SlidesJsonResponse, sliderId: string): RatingTeaserSlideTemplateArgs[] => {\n  return slides.data.map((slide, index) => ({\n    sliderId,\n    slideIndex: index,\n    slidesLength: slides.data.length,\n    consultingRating: slide.consultingRating,\n    satisfactionRating: slide.satisfactionRating,\n    serviceRating: slide.serviceRating,\n    rating: slide.rating,\n    vbName: slide.vbName,\n    vbImageUrl: slide.vbImageUrl,\n    vbHomepageUrl: slide.vbHomepageUrl,\n    vbLocation: slide.vbLocation,\n    headline: slide.headline,\n    text: slide.text,\n    reviewFrom: slide.reviewFrom,\n    reviewerCustomerSince: slide.reviewerCustomerSince,\n    ratingDate: slide.ratingDate,\n  }));\n};\n\nexport default async function (block: HTMLElement) {\n  try {\n    const sliderId = uuidv4();\n    const subheadline = block.children[0].textContent || \"\";\n    const headline = block.children[1].textContent || \"\";\n    const text = block.children[2].innerHTML || \"\";\n    const slidesEndpoint = block.children[3].textContent || \"\";\n    const slides = await fetchService.fetchJson<SlidesJsonResponse>(slidesEndpoint.trim());\n    const cta = block.children[4].getElementsByTagName(\"a\")[0];\n    const ctaLabel = cta.textContent || \"\";\n    const ctaUrl = cta.getAttribute(\"href\") || \"\";\n\n    cleanUpBlock(block);\n\n    render(\n      ratingTeaserSliderTemplate({\n        sliderId,\n        subheadline,\n        headline,\n        text,\n        slides: getSlidesTemplateArgs(slides, sliderId),\n        ctaLabel,\n        ctaUrl,\n      }),\n      block,\n    );\n  } catch (error) {\n    DebuggerService.error(\"rating-teaser-slider\", error);\n  }\n}\n"],"file":"rating-teaser-slider/rating-teaser-slider.js"}