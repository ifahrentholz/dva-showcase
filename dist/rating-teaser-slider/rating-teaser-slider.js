import{x as _,j as h}from"../__chunks__/lit-element.XkUWx5ik.js";import{w as H,u as K}from"../__chunks__/waitForInitialization.84r_x4UN.js";import{o as j}from"../__chunks__/unsafe-html.tmuruS4o.js";import{f as U}from"../__chunks__/fetch.service.FjW5hVu3.js";import{U as T,M as l,R as d,E as V,O as k,N as W,d as S,c as w,A as v}from"../__chunks__/cssClasses.s3_ov42m.js";import{l as J,b as L,d as Y,a as O,r as u,o as P,e as z,f as G,w as C,h as x,m as X}from"../__chunks__/index.module.Yd0OvkAt.js";import{I as A,O as q,a as Q}from"../__chunks__/eventTypes.grJVX5By.js";import{_ as R}from"../__chunks__/preload-helper.hlDPvxQM.js";import{c as Z}from"../__chunks__/cleanUpBlock.VYQGZKWT.js";import"../__chunks__/mediaQueries.0eOxrCUs.js";import"../__chunks__/LazyConnectService.yBR27czX.js";const ee=(a,e)=>a.length<=e?a:`${a.slice(0,e)}...`;var te=Object.defineProperty,ae=Object.getOwnPropertyDescriptor,c=(a,e,t,s)=>{for(var r=s>1?void 0:s?ae(e,t):e,n=a.length-1,i;n>=0;n--)(i=a[n])&&(r=(s?i(e,t,r):i(r))||r);return s&&r&&te(e,t,r),r};class o extends T{get mainRating(){return this.ratingBox.rating.toString()}get date(){return(this.ratingDate.innerText||"").trim()}get headline(){return(this.ratingHeadline.innerText||"").trim()}get fullText(){return(this.text.innerText||"").trim()}get customerInfo(){return(this.customerInformation.innerText||"").trim()}get customerName(){return(this.customerDisplayName.innerText||"").trim()}get consultingRating(){return(this.getAttribute("consulting-rating")||"0").trim()}get satisfactionRating(){return(this.getAttribute("satisfaction-rating")||"0").trim()}get serviceRating(){return(this.getAttribute("service-rating")||"0").trim()}get vbName(){return(this.getAttribute("vb-name")||"0").trim()}get vbImage(){return(this.getAttribute("vb-image-url")||"0").trim()}get vbHomepage(){return(this.getAttribute("vb-homepage-url")||"0").trim()}get vbLocation(){return(this.getAttribute("vb-location")||"0").trim()}get teaserIdx(){return parseInt(this.getAttribute("teaser-index")||"0",10)}get hasPrevTeaser(){var e;return((e=this.parentElement)==null?void 0:e.previousElementSibling)!==null}get hasNextTeaser(){var e;return((e=this.parentElement)==null?void 0:e.nextElementSibling)!==null}get teaserData(){return{vbImg:this.vbImage,vbName:this.vbName,vbHomepage:this.vbHomepage,vbLocation:this.vbLocation,mainRating:this.mainRating,date:this.date,headline:this.headline,text:this.fullText,customerName:this.customerName,customerInfo:this.customerInfo,ratings:{consulting:this.consultingRating,satisfaction:this.satisfactionRating,service:this.serviceRating},hasPrevTeaser:this.hasPrevTeaser,hasNextTeaser:this.hasNextTeaser}}afterComponentRender(){this.convertDate()}convertDate(){const e=parseInt(this.createdDate.getAttribute("date")||"0",10),t=new Date(e),s=[{label:"Jahr",labelPlural:"Jahren",seconds:3600*24*365},{label:"Monat",labelPlural:"Monaten",seconds:3600*24*30},{label:"Woche",labelPlural:"Wochen",seconds:3600*24*7},{label:"Tag",labelPlural:"Tagen",seconds:3600*24},{label:"Stunde",labelPlural:"Stunden",seconds:3600},{label:"Minute",labelPlural:"Minuten",seconds:60},{label:"Sekunde",labelPlural:"Sekunden",seconds:1}],r=Math.floor((Date.now()-t.getTime())/1e3),n=s.find(i=>i.seconds<r);if(n!==void 0){const i=Math.floor(r/n.seconds),b=i>1?n.labelPlural:n.label;this.createdDate.innerHTML=`vor ${i} ${b}`}else this.createdDate.innerHTML=`${t.toLocaleDateString("de-DE")}`}openOverlay(e){e.preventDefault(),this.dispatchEvent(new CustomEvent("dva-open-overlay",{detail:{target:this,data:this.teaserData,teaserIdx:this.teaserIdx}}))}}c([l(".dvag-m-c01e-teaser__cta")],o.prototype,"overlayCta",2);c([l(".dva-m-rating-box")],o.prototype,"ratingBox",2);c([l(".dvag-m-c01e-teaser__rating-date")],o.prototype,"ratingDate",2);c([l(".dvag-m-c01e-teaser__headline")],o.prototype,"ratingHeadline",2);c([l(".dvag-m-c01e-teaser__full-text")],o.prototype,"text",2);c([l(".dvag-m-c01e-teaser__customer-name")],o.prototype,"customerDisplayName",2);c([l(".dvag-m-c01e-teaser__customer-information")],o.prototype,"customerInformation",2);c([l(".dvag-m-c01e-teaser__rating-date")],o.prototype,"createdDate",2);c([d("overlayCta","click")],o.prototype,"openOverlay",1);customElements.define("dvag-m-c01e-teaser",o);const re=(a,e,t)=>_`<dva-e-icon class="dva-e-rating-star${a!=="no"?` dva-e-rating-star--${a}`:""}" icon-id="dva-icon-star" ?half-filled="${a==="half"}" @click="${()=>{t.editMode&&(t.rating=e+1)}}"></dva-e-icon>`,se=(a,e)=>e+.5<a,ne=(a,e)=>e+1>a&&e+.1<=a,ie=a=>new Array(5).fill(!0).map((e,t)=>se(a.curRating,t)?"full":ne(a.curRating,t)?"half":"no"),le=a=>_`<div class="dva-m-rating-box__ratingstar-wrapper">${ie(a).map((e,t)=>re(e,t,a.ratingBox))}</div><span class="dvag-e-form-field__error"><dva-e-icon class="dvag-e-form-field__error-icon" icon-id="dva-icon-error-16px"></dva-e-icon>Bitte bewerten Sie.</span>`;var oe=Object.defineProperty,ce=Object.getOwnPropertyDescriptor,de=(a,e,t,s)=>{for(var r=s>1?void 0:s?ce(e,t):e,n=a.length-1,i;n>=0;n--)(i=a[n])&&(r=(s?i(e,t,r):i(r))||r);return s&&r&&oe(e,t,r),r};class M extends T{constructor(){super({events:[{event:A,target:"this",handler:"handleIntersectionChange"}],initialStates:{loaded:!1,inValidationMode:!1},reactions:{inValidationMode:["renderComponent"]}}),this.viewportObserver=J.getInstance(),this.editMode=!1}static get observedAttributes(){return["rating"]}attributeChangedCallback(e,t,s){e==="rating"&&t!==s&&this.state.initialized&&this.renderComponent()}afterComponentRender(){this.viewportObserver.observe(this)}get rating(){return parseFloat((this.getAttribute("rating")||"5").replace(",","."))}set rating(e){this.setAttribute("rating",e.toString())}get name(){return this.getAttribute("name")||""}handleIntersectionChange(){this.viewportObserver.unobserve(this),L(this,A,this.handleIntersectionChange,this),this.state.loaded||this.renderComponent()}renderComponent(){this.state.inValidationMode&&Y(this,V,this.rating===0),h(le({curRating:this.rating,ratingBox:this}),this)}validate(){this.editMode&&this.setState({inValidationMode:!0})}}de([k],M.prototype,"editMode",2);customElements.define("dva-m-rating-box",M);var ve=Object.defineProperty,ge=Object.getOwnPropertyDescriptor,m=(a,e,t,s)=>{for(var r=s>1?void 0:s?ge(e,t):e,n=a.length-1,i;n>=0;n--)(i=a[n])&&(r=(s?i(e,t,r):i(r))||r);return s&&r&&ve(e,t,r),r};class g extends T{constructor(){super({initialStates:{overlayTeaser:-1},reactions:{overlayTeaser:["renderOverlay"]}})}get lastTeaser(){return this.teasers.length-1}openOverlay({detail:e}){this.setState({overlayTeaser:e.teaserIdx})}renderOverlay({overlayTeaser:e}){if(e<-1){this.setState({overlayTeaser:-1},{silent:!0});return}if(e!==-1){if(e>this.lastTeaser){this.setState({overlayTeaser:this.lastTeaser},{silent:!0});return}this.overlay.setState({args:this.teasers[e].teaserData})}}handleOverlayNav({detail:e}){if(e.direction==="prev"&&this.state.overlayTeaser===0)return;let t=this.state.overlayTeaser+1;e.direction==="prev"&&(t-=2),this.setState({overlayTeaser:t})}handleOverlayClosed(){this.setState({overlayTeaser:-1})}}m([W(".dvag-m-c01e-teaser")],g.prototype,"teasers",2);m([l(".dvag-m-c01e-teaser-overlay")],g.prototype,"overlay",2);m([d("teasers","dva-open-overlay")],g.prototype,"openOverlay",1);m([d("overlay","dvag-m-c01e-teaser-overlay-nav")],g.prototype,"handleOverlayNav",1);m([d("overlay","dva-overlay-closed")],g.prototype,"handleOverlayClosed",1);customElements.define("dvag-m-c07-rating-teaser-slider",g);let $=0;const he=()=>{$=window.pageYOffset,O(document.body,S),document.body.style.top=`-${$}px`},ue=()=>{u(document.body,S),document.body.style.top="",window.scrollTo(0,$)};class me{constructor(){this.debugModeActive=!1}log(e,...t){this.debugModeActive!==!1&&console.log(e,...t)}warn(e,...t){this.debugModeActive!==!1&&console.warn(e,...t)}error(e,...t){this.debugModeActive!==!1&&console.error(e,...t)}}const pe=new me,f=class f{constructor(){this._focusTrapped=!1,this.tabableElementsMap=new WeakMap,this.trapTargetList=[],this.eventBindingMap={},this.eventIdMap=new WeakMap}get focusTrapped(){return this._focusTrapped}set focusTrapped(e){this._focusTrapped!==e&&(e===!0?P(document.body,["keydown"],this.handleKeyDown,this):L(document.body,["keydown"],this.handleKeyDown,this),this._focusTrapped=e)}get currentTrapTarget(){return this.trapTargetList.length===0?null:this.trapTargetList[this.trapTargetList.length-1]}get firstTabableElement(){return this.currentTrapTarget===null?null:this.getFirstTabableElementOf(this.currentTrapTarget)}get lastTabableElement(){return this.currentTrapTarget===null?null:this.getLastTabableElementOf(this.currentTrapTarget)}get firstTabableElementActive(){return this.currentTrapTarget===null?!1:this.isFirstTabableElementActive(this.currentTrapTarget)}get lastTabableElementActive(){return this.currentTrapTarget===null?!1:this.isLastTabableElementActive(this.currentTrapTarget)}trapFocusIn(e){var s;const t=this.tabableElementsIn(e);t.length!==0&&(this.trapTargetList.push(e),this.tabableElementsMap.set(e,{activeElementBeforeTrapped:document.activeElement,tabableElements:t}),this.focusTrapped=!0,(s=this.firstTabableElement)==null||s.focus())}unTrapFocusIn(e){var s;this.trapTargetList=this.trapTargetList.filter(r=>r!==e);const t=((s=this.tabableElementsMap.get(e))==null?void 0:s.activeElementBeforeTrapped)||null;try{t!==null&&t.focus()}catch(r){pe.error("FocusService: ",r)}this.tabableElementsMap.delete(e),this.trapTargetList.length===0&&(this.focusTrapped=!1)}handleKeyDown(e){var t,s;e.key==="Tab"&&(e.shiftKey&&this.firstTabableElementActive?((t=this.lastTabableElement)==null||t.focus(),e.preventDefault()):e.shiftKey===!1&&this.lastTabableElementActive&&((s=this.firstTabableElement)==null||s.focus(),e.preventDefault()))}tabableElementsIn(e){return z(e,f.TABABLE_ELEMENTS_SELECTOR)}getFirstTabableElementOf(e){var s;const t=((s=this.tabableElementsMap.get(e))==null?void 0:s.tabableElements)||[];return t.length===0?null:t[0]}getLastTabableElementOf(e){var s;const t=((s=this.tabableElementsMap.get(e))==null?void 0:s.tabableElements)||[];return t.length===0?null:t[t.length-1]}isFirstTabableElementActive(e){const t=this.getFirstTabableElementOf(e);return t===null?!1:t===document.activeElement}isLastTabableElementActive(e){const t=this.getLastTabableElementOf(e);return t===null?!1:t===document.activeElement}};f.TABABLE_ELEMENTS_SELECTOR='button, a[href], input, select, textarea, [tabindex]:not([tabindex="-1"])';let I=f;const D=new I;class be{constructor(){this.lightboxInstance=null}createLightbox(e){this.renderLightbox({imageUrl:e,cssClasses:"dvag-m-basic-overlay--lightbox"})}destroyLightbox(){this.lightboxInstance!==null&&(this.lightboxInstance.close(),document.body.removeChild(this.lightboxInstance),this.lightboxInstance=null)}async renderLightbox(e){const t=await this.loadOverlayTemplate(),s=document.createElement("div");h(t(e),s);const r=G(s,".dvag-m-basic-overlay");r!==null&&(document.body.appendChild(r),this.lightboxInstance=r,await H(r),r.open())}async loadOverlayTemplate(){const{renderBasicOverlayAsLightbox:e}=await R(()=>import("../__chunks__/dvag-m-basic-overlay.template.jjht13G0.js"),__vite__mapDeps([0,1]));return e}}const fe=new be;var _e=Object.defineProperty,Te=Object.getOwnPropertyDescriptor,N=(a,e,t,s)=>{for(var r=s>1?void 0:s?Te(e,t):e,n=a.length-1,i;n>=0;n--)(i=a[n])&&(r=(s?i(e,t,r):i(r))||r);return s&&r&&_e(e,t,r),r};class y extends T{async close(){ue(),u(this,w),await C(300),u(this,v),L(window,"keyup",this.handleKeyboardsEvents,this),D.unTrapFocusIn(this),fe.destroyLightbox(),this.dispatchEvent(new CustomEvent(q))}async open(){he(),O(this,v),await C(100),O(this,w),P(window,"keyup",this.handleKeyboardsEvents,this),D.trapFocusIn(this),this.dispatchEvent(new CustomEvent(Q))}handleKeyboardsEvents(e){e.key==="Escape"&&this.close()}handleCookieChange(){}handleOverlayClick(e){}handleCloseBtnClick(){this.close()}}N([l(".dvag-m-basic-overlay__close")],y.prototype,"closeBtn",2);N([d("closeBtn","click")],y.prototype,"handleCloseBtnClick",1);customElements.define("dvag-m-basic-overlay",y);var ye=Object.defineProperty,Ee=Object.getOwnPropertyDescriptor,E=(a,e,t,s)=>{for(var r=s>1?void 0:s?Ee(e,t):e,n=a.length-1,i;n>=0;n--)(i=a[n])&&(r=(s?i(e,t,r):i(r))||r);return s&&r&&ye(e,t,r),r};class p extends y{constructor(){super({initialStates:{args:null},reactions:{args:["openOverlay"]},asyncRendering:!0})}get defaultArgs(){return{vbImg:"",vbName:"",vbHomepage:"",vbLocation:"",mainRating:"0",date:"",headline:"",text:"",customerName:"",customerInfo:"",ratings:{consulting:"0",satisfaction:"0",service:"0"},hasPrevTeaser:!1,hasNextTeaser:!1}}async renderAsync(){try{const e=await this.loadTemplate();h(e(this.defaultArgs),this)}catch(e){console.error("Overlay:",e)}}async loadTemplate(){const{ratingOverlayTemplate:e}=await R(()=>import("../__chunks__/dvag-m-c01e-teaser-overlay.template.P642BcYW.js"),__vite__mapDeps([2,1,3,4]));return e}async openOverlay({args:e}){if(e===null)return;const t=await this.loadTemplate();h(t(e),this),!x(this,v)&&super.open()}async close(){this.setState({args:null}),u(this,w),await C(300),u(this,v),this.dispatchEvent(new CustomEvent("dva-overlay-closed",{detail:{target:this}})),super.close()}loadPrevTeaser(){this.dispatchEvent(new CustomEvent("dvag-m-c01e-teaser-overlay-nav",{detail:{target:this,direction:"prev"}}))}loadNextTeaser(){this.dispatchEvent(new CustomEvent("dvag-m-c01e-teaser-overlay-nav",{detail:{target:this,direction:"next"}}))}handleKeyup(e){switch(e.key){case"Escape":this.close();break;case"ArrowRight":x(this,v)&&this.loadNextTeaser();break;case"ArrowLeft":x(this,v)&&this.loadPrevTeaser();break}}}E([l(".dvag-m-c01e-teaser-overlay__nav-btn--prev")],p.prototype,"prevBtn",2);E([l(".dvag-m-c01e-teaser-overlay__nav-btn--next")],p.prototype,"nextBtn",2);E([d("prevBtn","click")],p.prototype,"loadPrevTeaser",1);E([d("nextBtn","click")],p.prototype,"loadNextTeaser",1);customElements.define("dvag-m-c01e-teaser-overlay",p);const xe=a=>_`<div id="c07-ratingteaserslider-${a.sliderId}-slide-${a.slideIndex+1}" class="dvag-m-basic-slider__slide" aria-roledescription="slide" aria-label="${`Slide ${a.slideIndex+1} of ${a.slidesLength}`}"><dvag-m-c01e-teaser class="dvag-m-c01e-teaser" teaser-index="${a.slideIndex}" consulting-rating="${a.consultingRating}" satisfaction-rating="${a.satisfactionRating}" service-rating="${a.serviceRating}" vb-name="${a.vbName}" vb-image-url="${a.vbImageUrl}" vb-homepage-url="${a.vbHomepageUrl}" vb-location="${a.vbLocation}"><div class="dvag-m-c01e-teaser__content"><div class="dvag-m-c01e-teaser__rating-wrapper"><dva-m-rating-box class="dva-m-rating-box dvag-m-c01e-teaser__main-rating" rating="${a.rating}"></dva-m-rating-box><p class="dvag-m-c01e-teaser__rating-label">${a.rating} von 5 Sternen</p></div><h3 class="dvag-m-c01e-teaser__headline">${a.headline}</h3><p class="dvag-m-c01e-teaser__text">${ee(a.text,157)}</p><p class="dvag-m-c01e-teaser__full-text">${a.text}</p><a href="#" class="dva-e-link dvag-m-c01e-teaser__cta"><span class="dva-e-link__label">Mehr erfahren</span><dva-e-icon class="dva-e-icon" icon-id="dva-icon-arrow-right-48px"></dva-e-icon></a></div><div class="dvag-m-c01e-teaser__footer"><h4 class="dvag-m-c01e-teaser__customer-label">Bewertet von:</h4><p class="dvag-m-c01e-teaser__customer-name">${a.reviewFrom}</p><p class="dvag-m-c01e-teaser__customer-info"><span class="dvag-m-c01e-teaser__rating-date" date="${a.ratingDate}">${a.ratingDate}</span>, <span class="dvag-m-c01e-teaser__customer-information">Kunde seit ${a.reviewerCustomerSince}</span></p></div></dvag-m-c01e-teaser></div>`,we=a=>_`<div class="c07-ratingteaserslider carousel dvag-h-margin-bottom--none dvag-h-margin-top--none dvag-h-background--grey dvag-h-skew--top*"><dvag-m-c07-rating-teaser-slider class="dvag-m-c07-rating-teaser-slider dvag-m-skew-component cmp-carousel" id="c07-ratingteaserslider-${a.sliderId}" role="group" data-cmp-is="carousel"><div class="dva-h-skew--in"></div><div class="dvag-m-skewed-box__content"><div class="dvag-m-c07-rating-teaser-slider__grid-wrapper"><div class="dvag-m-section-header"><h3 class="dvag-m-section-header__subheadline">${a.subheadline}</h3><h2 class="dvag-m-section-header__headline">${a.headline}</h2><div class="dvag-m-section-header__text dvag-e-richtext">${j(a.text)}</div></div></div><dvag-m-basic-slider class="dvag-m-basic-slider dvag-m-teaser-slider cmp-carousel" title="Das sagen meine Kunden" id="c07-ratingteaserslider-${a.sliderId}-slider" role="group" aria-live="polite" aria-roledescription="carousel" data-cmp-is="carousel"><div class="dvag-m-basic-slider__slides">${a.slides.map(e=>xe(e))}</div><div class="dvag-m-basic-slider__controls"><button class="dva-e-button dva-e-button--primary dva-e-button--rebrush dvag-m-basic-slider__nav-button dvag-m-basic-slider__nav-button--prev"><div class="dva-e-button__background"></div><dva-e-icon class="dva-e-icon" icon-id="dva-icon-chevron-left"></dva-e-icon></button> <button class="dva-e-button dva-e-button--primary dva-e-button--rebrush dvag-m-basic-slider__nav-button dvag-m-basic-slider__nav-button--next dva-state-visible"><div class="dva-e-button__background"></div><dva-e-icon class="dva-e-icon" icon-id="dva-icon-chevron-right"></dva-e-icon></button></div><div class="dvag-m-basic-slider__grid-container-wrapper"><div class="dvag-m-basic-slider__scroll-bar"><button class="dvag-m-basic-slider__scroll-indicator" tabindex="-1" style="width:19.9077%;transform:translateX(0)"></button></div></div></dvag-m-basic-slider><dvag-m-c01e-teaser-overlay class="dvag-m-c01e-teaser-overlay"></dvag-m-c01e-teaser-overlay><div class="dvag-m-c07-rating-teaser-slider__grid-wrapper"><div class="dvag-m-c07-rating-teaser-slider__button-wrapper"><a class="dva-e-button dva-e-button--rebrush" href="${a.ctaUrl}"><div class="dva-e-button__background"></div><span class="dva-e-button__label">${a.ctaLabel}</span></a></div></div></div><div class="dva-h-skew--out"></div></dvag-m-c07-rating-teaser-slider></div>`,Oe=(a,e)=>a.data.map((t,s)=>({sliderId:e,slideIndex:s,slidesLength:a.data.length,consultingRating:t.consultingRating,satisfactionRating:t.satisfactionRating,serviceRating:t.serviceRating,rating:t.rating,vbName:t.vbName,vbImageUrl:t.vbImageUrl,vbHomepageUrl:t.vbHomepageUrl,vbLocation:t.vbLocation,headline:t.headline,text:t.text,reviewFrom:t.reviewFrom,reviewerCustomerSince:t.reviewerCustomerSince,ratingDate:t.ratingDate}));async function Be(a){try{const e=K.v4(),t=a.children[0].textContent||"",s=a.children[1].textContent||"",r=a.children[2].innerHTML||"",n=a.children[3].textContent||"",i=await U.fetchJson(n.trim()),b=a.children[4].getElementsByTagName("a")[0],B=b.textContent||"",F=b.getAttribute("href")||"";Z(a),h(we({sliderId:e,subheadline:t,headline:s,text:r,slides:Oe(i,e),ctaLabel:B,ctaUrl:F}),a)}catch(e){X.error("rating-teaser-slider",e)}}export{Be as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["__chunks__/dvag-m-basic-overlay.template.jjht13G0.js","__chunks__/lit-element.XkUWx5ik.js","__chunks__/dvag-m-c01e-teaser-overlay.template.P642BcYW.js","__chunks__/cssClasses.s3_ov42m.js","__chunks__/index.module.Yd0OvkAt.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
//# sourceMappingURL=rating-teaser-slider.js.map
