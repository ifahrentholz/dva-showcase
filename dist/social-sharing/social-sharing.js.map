{"version":3,"file":"social-sharing.js","sources":["../../src/components/dva-m-social-sharing/dva-m-social-sharing.ts","../../src/blocks/social-sharing/social-sharing.ts"],"sourcesContent":["import { throttle } from '@kluntje/js-utils/lib/function-helpers/decorators';\nimport { Component } from '@kluntje/core';\nimport { ViewportObserver } from '@kluntje/services';\nimport { toggleClass } from '@kluntje/js-utils/lib/dom-helpers';\nimport { fetchJSON } from '@kluntje/js-utils/lib/api-helpers';\nimport { ACTIVE, HIDDEN } from 'Constants/cssClasses';\nimport { IN_VIEWPORT_EVENT, OUT_VIEWPORT_EVENT } from 'Constants/eventTypes';\n\nclass DvaSocialSharing extends Component {\n  viewportObserver = ViewportObserver.getInstance();\n  constructor() {\n    super({\n      ui: {\n        stickyBox: '.dva-js-social-sharing__sticky :-one',\n        stickyToggle: '.dva-js-social-sharing__sticky-icon :-one',\n        shareLink: '.dva-js-social-sharing__share-link',\n      },\n      events: [\n        {\n          event: 'scroll',\n          target: 'window',\n          handler: 'onScroll',\n        },\n        {\n          event: 'click',\n          target: 'stickyToggle',\n          handler: 'toggleSticky',\n        },\n        {\n          event: IN_VIEWPORT_EVENT,\n          target: 'this',\n          handler: 'handleInVP',\n        },\n        {\n          event: OUT_VIEWPORT_EVENT,\n          target: 'this',\n          handler: 'handleOutVP',\n        },\n        {\n          event: 'click',\n          target: 'shareLink',\n          handler: 'handleShare',\n        },\n      ],\n      initialStates: {\n        isActive: true,\n        isVisible: true,\n      },\n      reactions: {\n        isActive: ['onActiveChange'],\n        isVisible: ['onVisibleChange'],\n      },\n    });\n  }\n\n  /**\n   * Returns value of share-event-url Attribute needed\n   * to count shares in BE\n   * @returns {string}\n   */\n  get sharingUrl(): string {\n    return this.getAttribute('share-event-url') || '';\n  }\n\n  /**\n   * return current ScrollY Position of window\n   * @returns {Number}\n   */\n  get pageScrollY(): number {\n    return window.pageYOffset || document.documentElement.scrollTop;\n  }\n\n  /**\n   * return whether scrollup-button should be visible\n   * @returns {Boolean}\n   */\n  get shouldBeActive(): boolean {\n    return this.pageScrollY < 50;\n  }\n\n  /**\n   * sets initial sticky state\n   */\n  afterComponentRender(): void {\n    this.viewportObserver.observe(this);\n    this.setState({ isActive: this.shouldBeActive });\n  }\n\n  /**\n   * handles page-scroll, by setting active-state and updating lastScroll-value\n   */\n  @throttle(100)\n  onScroll(): void {\n    this.setState({ isActive: this.shouldBeActive });\n  }\n\n  /**\n   * scrolls page to top\n   */\n  scrollToTop(): void {\n    window.scrollTo({\n      top: 0,\n      left: 0,\n      behavior: 'smooth',\n    });\n  }\n\n  /**\n   * handles click on sticky-bar by toggeling the isActive-state\n   */\n  toggleSticky(): void {\n    this.setState({ isActive: !this.state.isActive });\n  }\n\n  /**\n   * handle active-state-chage, by toggleing ACTIVE-class\n   * @param {state.isActive} state.isActive\n   */\n  onActiveChange({ isActive }: any): void {\n    toggleClass(this.ui.stickyBox, ACTIVE, isActive);\n  }\n\n  /**\n   * handles kl-in-vp event, by setting isVisible-state\n   */\n  handleInVP(): void {\n    this.setState({ isVisible: false });\n  }\n\n  /**\n   * handles kl-out-vp event, by setting isVisible-state\n   */\n  handleOutVP() {\n    this.setState({ isVisible: true });\n  }\n\n  /**\n   * handles isVisible-state change,\n   * by setting HIDDEN class to stickyBox\n   */\n  onVisibleChange({ isVisible }: any) {\n    toggleClass(this.ui.stickyBox, HIDDEN, !isVisible);\n  }\n\n  /**\n   * Handles click on sharing Link, by fetching sharing URL\n   * in order to count Article share\n   */\n  handleShare(): void {\n    if (this.sharingUrl !== '') fetchJSON(this.sharingUrl);\n  }\n}\n\ncustomElements.define('dva-m-social-sharing', DvaSocialSharing);\n","import { html, render } from 'lit';\nimport { ifDefined } from 'lit-html/directives/if-defined.js';\nimport './social-sharing.scss';\nimport { cleanUpBlock } from 'Utils/cleanUpBlock';\nimport 'Components/dva-m-social-sharing/dva-m-social-sharing';\n\ninterface SocialSharingTemplateArgs {\n  name?: string | null;\n  url?: string | null;\n}\n\nconst socialTemplateOverview = (args: SocialSharingTemplateArgs[]) => {\n  return html`\n    <dva-m-social-sharing\n      class=\"dva-m-social-sharing\"\n      data-analytics-articleshare=\"true\"\n      share-event-url=\"https://sma.dvag.de/count-service/v1/increase-share/wichtig-fuer-sie/vorsorge/attraktive-zusatzleistungen-vom-arbeitgeber-nutzen-bav-und-bkv\"\n    >\n      <header class=\"dva-m-social-sharing__head\">\n        <dva-e-icon class=\"dva-m-social-sharing__head-icon\" icon-id=\"dva-icon-share\"></dva-e-icon>\n        <h3 class=\"dva-m-social-sharing__headline\">Artikel teilen</h3>\n      </header>\n      <div class=\"dva-m-social-sharing__icons\">\n        ${args.map(\n          (item) => html`\n            <a\n              class=\"dva-e-button dva-e-button--secondary dva-e-button--icon-only dva-m-social-sharing__button dva-js-social-sharing__share-link\"\n              href=\"${ifDefined(item.url)}\"\n              title=\"${ifDefined(item.name)}\"\n              target=\"_blank\"\n            >\n              <div class=\"dva-e-button__background\"></div>\n              <dva-e-icon class=\"dva-e-button__icon\" icon-id=\"dva-icon-${item.name}\"></dva-e-icon>\n            </a>\n          `\n        )}\n      </div>\n\n      <div class=\"dva-m-social-sharing__sticky dva-js-social-sharing__sticky dva-state-active\">\n        <dva-e-icon\n          class=\"dva-m-social-sharing__sticky-icon dva-m-social-sharing__sticky-icon--main dva-js-social-sharing__sticky-icon\"\n          icon-id=\"dva-icon-share\"\n        ></dva-e-icon>\n        ${args.map(\n          (item) => html`\n            <a href=\"${item.url}\" class=\"dva-m-social-sharing__sticky-link dva-js-social-sharing__share-link\">\n              <dva-e-icon class=\"dva-m-social-sharing__sticky-icon\" icon-id=\"dva-icon-${item.name}\"></dva-e-icon>\n            </a>\n          `\n        )}\n      </div>\n    </dva-m-social-sharing>\n  `;\n};\nexport default function (block: HTMLElement) {\n  const rows = [...block.children];\n  const templateArgs = rows.map((row) => {\n    const name = row.children[0].textContent;\n    const url = row.children[1].textContent;\n    return { name, url };\n  });\n  cleanUpBlock(block);\n  render(socialTemplateOverview(templateArgs), block);\n}\n"],"names":["DvaSocialSharing","Component","IN_VIEWPORT_EVENT","OUT_VIEWPORT_EVENT","ViewportObserver","isActive","toggleClass","ACTIVE","isVisible","HIDDEN","fetchJSON","__decorateClass","throttle","socialTemplateOverview","args","html","item","ifDefined","socialSharing","block","templateArgs","row","name","url","cleanUpBlock","render"],"mappings":"ooBAQA,MAAMA,UAAyBC,CAAU,CAEvC,aAAc,CACN,MAAA,CACJ,GAAI,CACF,UAAW,uCACX,aAAc,4CACd,UAAW,oCACb,EACA,OAAQ,CACN,CACE,MAAO,SACP,OAAQ,SACR,QAAS,UACX,EACA,CACE,MAAO,QACP,OAAQ,eACR,QAAS,cACX,EACA,CACE,MAAOC,EACP,OAAQ,OACR,QAAS,YACX,EACA,CACE,MAAOC,EACP,OAAQ,OACR,QAAS,aACX,EACA,CACE,MAAO,QACP,OAAQ,YACR,QAAS,aACX,CACF,EACA,cAAe,CACb,SAAU,GACV,UAAW,EACb,EACA,UAAW,CACT,SAAU,CAAC,gBAAgB,EAC3B,UAAW,CAAC,iBAAiB,CAC/B,CAAA,CACD,EA3CH,KAAA,iBAAmBC,EAAiB,aA4CpC,CAOA,IAAI,YAAqB,CAChB,OAAA,KAAK,aAAa,iBAAiB,GAAK,EACjD,CAMA,IAAI,aAAsB,CACjB,OAAA,OAAO,aAAe,SAAS,gBAAgB,SACxD,CAMA,IAAI,gBAA0B,CAC5B,OAAO,KAAK,YAAc,EAC5B,CAKA,sBAA6B,CACtB,KAAA,iBAAiB,QAAQ,IAAI,EAClC,KAAK,SAAS,CAAE,SAAU,KAAK,cAAgB,CAAA,CACjD,CAMA,UAAiB,CACf,KAAK,SAAS,CAAE,SAAU,KAAK,cAAgB,CAAA,CACjD,CAKA,aAAoB,CAClB,OAAO,SAAS,CACd,IAAK,EACL,KAAM,EACN,SAAU,QAAA,CACX,CACH,CAKA,cAAqB,CACnB,KAAK,SAAS,CAAE,SAAU,CAAC,KAAK,MAAM,SAAU,CAClD,CAMA,eAAe,CAAE,SAAAC,GAAuB,CACtCC,EAAY,KAAK,GAAG,UAAWC,EAAQF,CAAQ,CACjD,CAKA,YAAmB,CACjB,KAAK,SAAS,CAAE,UAAW,EAAO,CAAA,CACpC,CAKA,aAAc,CACZ,KAAK,SAAS,CAAE,UAAW,EAAM,CAAA,CACnC,CAMA,gBAAgB,CAAE,UAAAG,GAAkB,CAClCF,EAAY,KAAK,GAAG,UAAWG,EAAQ,CAACD,CAAS,CACnD,CAMA,aAAoB,CACd,KAAK,aAAe,IAAIE,EAAU,KAAK,UAAU,CACvD,CACF,CA3DEC,EAAA,CADCC,EAAS,GAAG,CAAA,EAnFTZ,EAoFJ,UAAA,WAAA,CAAA,EA6DF,eAAe,OAAO,uBAAwBA,CAAgB,EC9I9D,MAAMa,EAA0BC,GACvBC,8eAWCD,EAAK,IACJE,GAASD,iJAGEE,EAAUD,EAAK,GAAG,CAAC,YAClBC,EAAUD,EAAK,IAAI,CAAC,0HAI8BA,EAAK,IAAI,qBAAA,CAGzE,yQAQCF,EAAK,IACJE,GAASD,aACGC,EAAK,GAAG,yJACyDA,EAAK,IAAI,qBAGxF,CAAA,gCAKT,SAAAE,EAAyBC,EAAoB,CAE3C,MAAMC,EADO,CAAC,GAAGD,EAAM,QAAQ,EACL,IAAKE,GAAQ,CACrC,MAAMC,EAAOD,EAAI,SAAS,CAAC,EAAE,YACvBE,EAAMF,EAAI,SAAS,CAAC,EAAE,YACrB,MAAA,CAAE,KAAAC,EAAM,IAAAC,EAAI,CACpB,EACDC,EAAaL,CAAK,EACXM,EAAAZ,EAAuBO,CAAY,EAAGD,CAAK,CACpD"}