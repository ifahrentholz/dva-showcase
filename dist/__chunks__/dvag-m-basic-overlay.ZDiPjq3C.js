import{U as y,M as L,R as w}from"./component.module.Hp3Pacc1.js";import{a as o,r as c,o as E,c as T,k as _,f as A,w as p}from"./index.module.1ng6vgY5.js";import{S as g,c as d,A as f}from"./cssClasses.wlqlOWT8.js";import{a as O,b as x}from"./eventTypes.voneREpA.js";import{_ as C}from"./preload-helper.hlDPvxQM.js";import{j as I}from"./lit-element.XkUWx5ik.js";import{w as M}from"./waitForInitialization.QHl8FaNN.js";let h=0;const B=()=>{h=window.pageYOffset,o(document.body,g),document.body.style.top=`-${h}px`},D=()=>{c(document.body,g),document.body.style.top="",window.scrollTo(0,h)};class S{constructor(){this.debugModeActive=!1}log(e,...t){this.debugModeActive!==!1&&console.log(e,...t)}warn(e,...t){this.debugModeActive!==!1&&console.warn(e,...t)}error(e,...t){this.debugModeActive!==!1&&console.error(e,...t)}}const k=new S,n=class n{constructor(){this._focusTrapped=!1,this.tabableElementsMap=new WeakMap,this.trapTargetList=[],this.eventBindingMap={},this.eventIdMap=new WeakMap}get focusTrapped(){return this._focusTrapped}set focusTrapped(e){this._focusTrapped!==e&&(e===!0?E(document.body,["keydown"],this.handleKeyDown,this):T(document.body,["keydown"],this.handleKeyDown,this),this._focusTrapped=e)}get currentTrapTarget(){return this.trapTargetList.length===0?null:this.trapTargetList[this.trapTargetList.length-1]}get firstTabableElement(){return this.currentTrapTarget===null?null:this.getFirstTabableElementOf(this.currentTrapTarget)}get lastTabableElement(){return this.currentTrapTarget===null?null:this.getLastTabableElementOf(this.currentTrapTarget)}get firstTabableElementActive(){return this.currentTrapTarget===null?!1:this.isFirstTabableElementActive(this.currentTrapTarget)}get lastTabableElementActive(){return this.currentTrapTarget===null?!1:this.isLastTabableElementActive(this.currentTrapTarget)}trapFocusIn(e){var a;const t=this.tabableElementsIn(e);t.length!==0&&(this.trapTargetList.push(e),this.tabableElementsMap.set(e,{activeElementBeforeTrapped:document.activeElement,tabableElements:t}),this.focusTrapped=!0,(a=this.firstTabableElement)==null||a.focus())}unTrapFocusIn(e){var a;this.trapTargetList=this.trapTargetList.filter(s=>s!==e);const t=((a=this.tabableElementsMap.get(e))==null?void 0:a.activeElementBeforeTrapped)||null;try{t!==null&&t.focus()}catch(s){k.error("FocusService: ",s)}this.tabableElementsMap.delete(e),this.trapTargetList.length===0&&(this.focusTrapped=!1)}handleKeyDown(e){var t,a;e.key==="Tab"&&(e.shiftKey&&this.firstTabableElementActive?((t=this.lastTabableElement)==null||t.focus(),e.preventDefault()):e.shiftKey===!1&&this.lastTabableElementActive&&((a=this.firstTabableElement)==null||a.focus(),e.preventDefault()))}tabableElementsIn(e){return _(e,n.TABABLE_ELEMENTS_SELECTOR)}getFirstTabableElementOf(e){var a;const t=((a=this.tabableElementsMap.get(e))==null?void 0:a.tabableElements)||[];return t.length===0?null:t[0]}getLastTabableElementOf(e){var a;const t=((a=this.tabableElementsMap.get(e))==null?void 0:a.tabableElements)||[];return t.length===0?null:t[t.length-1]}isFirstTabableElementActive(e){const t=this.getFirstTabableElementOf(e);return t===null?!1:t===document.activeElement}isLastTabableElementActive(e){const t=this.getLastTabableElementOf(e);return t===null?!1:t===document.activeElement}};n.TABABLE_ELEMENTS_SELECTOR='button, a[href], input, select, textarea, [tabindex]:not([tabindex="-1"])';let b=n;const m=new b;class F{constructor(){this.lightboxInstance=null}createLightbox(e){this.renderLightbox({imageUrl:e,cssClasses:"dvag-m-basic-overlay--lightbox"})}destroyLightbox(){this.lightboxInstance!==null&&(this.lightboxInstance.close(),document.body.removeChild(this.lightboxInstance),this.lightboxInstance=null)}async renderLightbox(e){const t=await this.loadOverlayTemplate(),a=document.createElement("div");I(t(e),a);const s=A(a,".dvag-m-basic-overlay");s!==null&&(document.body.appendChild(s),this.lightboxInstance=s,await M(s),s.open())}async loadOverlayTemplate(){const{renderBasicOverlayAsLightbox:e}=await C(()=>import("./dvag-m-basic-overlay.template.jjht13G0.js"),__vite__mapDeps([0,1]));return e}}const K=new F;var P=Object.defineProperty,N=Object.getOwnPropertyDescriptor,v=(r,e,t,a)=>{for(var s=a>1?void 0:a?N(e,t):e,l=r.length-1,i;l>=0;l--)(i=r[l])&&(s=(a?i(e,t,s):i(s))||s);return a&&s&&P(e,t,s),s};class u extends y{async close(){D(),c(this,d),await p(300),c(this,f),T(window,"keyup",this.handleKeyboardsEvents,this),m.unTrapFocusIn(this),K.destroyLightbox(),this.dispatchEvent(new CustomEvent(O))}async open(){B(),o(this,f),await p(100),o(this,d),E(window,"keyup",this.handleKeyboardsEvents,this),m.trapFocusIn(this),this.dispatchEvent(new CustomEvent(x))}handleKeyboardsEvents(e){e.key==="Escape"&&this.close()}handleCookieChange(){}handleOverlayClick(e){}handleCloseBtnClick(){this.close()}}v([L(".dvag-m-basic-overlay__close")],u.prototype,"closeBtn",2);v([w("closeBtn","click")],u.prototype,"handleCloseBtnClick",1);customElements.define("dvag-m-basic-overlay",u);export{u as D};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["__chunks__/dvag-m-basic-overlay.template.jjht13G0.js","__chunks__/lit-element.XkUWx5ik.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
//# sourceMappingURL=dvag-m-basic-overlay.ZDiPjq3C.js.map
