import{g as k,c as z,o as u,p as D,f as y,j as E,k as f,q as I,s as w,u as O,v as T,e as V}from"./index.module.dAHZ1emY.js";var p={},m,A,S;Object.defineProperty(p,"__esModule",{value:!0});const C=(n,e)=>n.findIndex(t=>t===e)!==-1;S=p.hasElement=C,p.isFilledArray=n=>n!==void 0&&n.length>0,A=p.mergeArraysBy=(n,e,t)=>n.filter(i=>t(i,e)).concat(e),m=p.pushIfNew=(n,e)=>(C(n,e)||n.push(e),n),p.removeItem=(n,e)=>n.filter(t=>t!==e);var d={},R,U;Object.defineProperty(d,"__esModule",{value:!0});const M=n=>n.replace(/ +(?= )/g,""),j=n=>n.replace(/\r?\n|\r/g,"");d.getCleanString=n=>j(M(n)),d.getWordCount=n=>n.split(" ").length,U=d.removeAllBS=n=>n.replace(/\s/g,""),d.removeAllNL=j,d.removeMultiBS=M,d.toCamelCase=function(n){return n.toLowerCase().replace(/(-+|\s+)[a-z]/g,e=>e.toUpperCase()).replace(/(-|\s)+/g,"")},R=d.toKebabCase=function(n){return n.replace(/[A-Z]/g,e=>`-${e.toLocaleLowerCase()}`)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function g(n,e,t,i){return new(t||(t=Promise))(function(s,r){function a(c){try{o(i.next(c))}catch(l){r(l)}}function h(c){try{o(i.throw(c))}catch(l){r(l)}}function o(c){var l;c.done?s(c.value):(l=c.value,l instanceof t?l:new t(function(P){P(l)})).then(a,h)}o((i=i.apply(n,e||[])).next())})}const v=Symbol("decorated-props"),Q=["type","required","defaultValue","reactions","reactOnInit","attributeName"],b={required:!1,reactions:null,reactOnInit:!1};function N(n){return function(e,t){e[v]=e[v]||{},e[v][t]=n}}function q(n,e){return n instanceof HTMLElement?N(Object.assign({},b))(n,e):N(Object.assign(Object.assign({},b),n))}function L(n){return function(e,t){e.decoratedUiEls===void 0&&(e.decoratedUiEls=new Map),e.decoratedUiEls.set(t,{selector:n,justOne:!0,events:new Set})}}function B(n){return function(e,t){e.decoratedUiEls===void 0&&(e.decoratedUiEls=new Map),e.decoratedUiEls.set(t,{selector:n,justOne:!1,events:new Set})}}function F(n,e,t){return function(i,s){i.decoratedUiEls===void 0&&(i.decoratedUiEls=new Map);const r=i.decoratedUiEls.get(n);r!==void 0||n!=="window"&&n!=="this"?(r.events.add({eventName:e,handler:s,options:t}),i.decoratedUiEls.set(n,r)):i.decoratedUiEls.set(n.toString(),{selector:n,justOne:!0,events:new Set([{eventName:e,handler:s,options:t}])})}}function H(n){return function(e){return class extends e{get activeOnMQs(){const t=this.getAttribute("active-on-mq")||!1;if(!t)return!1;let i=[];return U(t).split(",").forEach(s=>{if(s.length===1)i=m(i,`MQ${s}`);else if(s.length>1){const r=s.split("-"),a=parseInt(r[0],10),h=parseInt(r[1],10);for(let o=a;o<=h;o++)i=m(i,`MQ${o.toString()}`)}}),i}get currentMQ(){return k(n)}get activeOnCurrentMQ(){return this.activeOnMQs&&S(this.activeOnMQs||[],this.currentMQ)||!this.activeOnMQs}handleMqChange(t){this.activeOnMQs&&(!this.state.initialized&&this.activeOnCurrentMQ?this.mqBasedConnect():this.state.initialized&&!this.activeOnCurrentMQ&&this.disconnectComponent())}mqBasedConnect(){this.activeOnCurrentMQ&&super.connectedCallback()}connectedCallback(){z.getInstance(n),u(window,D,this.handleMqChange,this),this.mqBasedConnect()}}}}const x="kl-component-initialized";class $ extends HTMLElement{constructor({ui:e={},events:t=[],initialStates:i={},reactions:s={},props:r={},useShadowDOM:a=!1,preserveChildren:h=!1,asyncRendering:o=!1}={}){super(),this.uiDefinitions={},this.ui={},this.events=[],this.reactions={initialized:["onComponentInitialized"]},this._state={},this._initialStates={},this.eventIdMap=new WeakMap,this.eventBindingMap={},this.initialStates={initialized:!1},this.useShadowDOM=a,this.preserveChildren=h,this.asyncRendering=o,this.useShadowDOM&&this.attachShadow({mode:"open"}),Object.assign(this.uiDefinitions,e),Object.assign(this.initialStates,i),Object.assign(this.reactions,s),this.addReactions(s),this.mergeEvents(t),this.props=this.normalizeProps(Object.assign(Object.assign({},this[v]||null),r))}get asyncRenderingEnabled(){return this._shouldRenderAsync||this.asyncRendering}connectedCallback(){this.setupComponent()}beforeComponentDisconnects(){}disconnectComponent(){this.beforeComponentDisconnects(),this.destroyComponentProps(),this.destroyComponent(),this.setState({initialized:!1})}renderingTemplate(){return null}renderComponent(){const e=this.renderingTemplate();e!==null&&this.render(e)}renderAsync(){return g(this,void 0,void 0,function*(){console.warn("please override renderAsync-method")})}render(e){this.preserveChildren||(this.getUiRoot().innerHTML=""),e instanceof HTMLTemplateElement?this.getUiRoot().appendChild(e.content.cloneNode(!0)):this.useShadowDOM?this.shadowRoot.innerHTML=e:this.insertAdjacentHTML("beforeend",e)}destroyComponent(){console.warn("please override destroyComponent-method")}afterComponentRender(){}onComponentInitialized(){this.dispatchEvent(new CustomEvent("kl-component-initialized",{bubbles:!1}))}waitForInitialization(){return g(this,void 0,void 0,function*(){if(!this.state.initialized)return yield V(this,"kl-component-initialized")})}setupComponent(){return g(this,void 0,void 0,function*(){this.asyncRenderingEnabled?yield this.renderAsync():this.renderComponent(),this.setupComponentProps(),this.afterComponentRender(),this.checkForMissingAttributes(),this.setState({initialized:!0})})}setupComponentProps(){this.enableDecoratedProperties(),this.generateUI(),this.generateEvents(),this.initializeProps()}destroyComponentProps(){this.destroyDecoratedProperties(),this.removeEvents(),this.ui={}}generateUI(){const e=this.getUiRoot();Object.keys(this.uiDefinitions).forEach(t=>{const i=this.uiDefinitions[t].trim();if(i.endsWith(":-one")){const s=i.replace(/:-one/g,"").trim();this.ui[t]=y(e,s)}else this.ui[t]=E(e,i)})}generateEvents(){this.events.forEach(e=>{if(typeof this[e.handler]=="function"){const t=this.getEventTargets(e.target);u(t,e.event,this[e.handler],this,e.options)}})}removeEvents(){this.events.forEach(e=>{if(typeof this[e.handler]=="function"){const t=this.getEventTargets(e.target);f(t,e.event,this[e.handler],this,e.options)}})}updateUI(){this.destroyDecoratedProperties(),this.enableDecoratedProperties(),this.ui={},this.generateUI()}updateEvents(){this.events.forEach(e=>{if(typeof this[e.handler]=="function"){const t=this.getEventTargets(e.target);f(t,e.event,this[e.handler],this,e.options),u(t,e.event,this[e.handler],this,e.options)}})}enableDecoratedProperties(){this.decoratedUiEls!==void 0&&this.decoratedUiEls.forEach((e,t)=>{if(e.selector==="window")e.events.forEach(i=>{u(window,i.eventName,this[i.handler],this,i.options)});else if(e.selector==="this")e.events.forEach(i=>{u(this,i.eventName,this[i.handler],this,i.options)});else{const i=e.justOne?y(this.getUiRoot(),e.selector):E(this.getUiRoot(),e.selector);this[t]=i,e.events.forEach(s=>{u(this[t],s.eventName,this[s.handler],this,s.options)})}})}destroyDecoratedProperties(){this.decoratedUiEls!==void 0&&this.decoratedUiEls.forEach((e,t)=>{e.selector==="window"?e.events.forEach(i=>{f(window,i.eventName,this[i.handler],this,i.options)}):e.selector==="this"?e.events.forEach(i=>{f(this,i.eventName,this[i.handler],this,i.options)}):(this[t]!=null&&e.events.forEach(s=>{f(this[t],s.eventName,this[s.handler],this,s.options)}),this[t]=void 0)})}initializeProps(){this.addDefaultValueAndType(this.props),this.addPropAccessors(this.props),this.addPropsReactions(this.props)}normalizeProps(e){const t={};return Object.entries(e).forEach(([i,s])=>{const r=typeof s=="object"&&s!==null&&Object.keys(s).length&&Object.keys(s).every(a=>Q.includes(a))?s:{defaultValue:s};r.attributeName=r.attributeName||R(i),t[i]=Object.assign(Object.assign({},b),r)}),t}addDefaultValueAndType(e){Object.entries(e).forEach(([t,i])=>{i.defaultValue=i.hasOwnProperty("defaultValue")?i.defaultValue:this[t],i.type=i.type||i.defaultValue!==null&&i.defaultValue!==void 0?typeof i.defaultValue:"string"})}addPropAccessors(e){for(const[t,i]of Object.entries(e))Object.defineProperty(this,t,{enumerable:!1,configurable:!0,set(s){s==null?this.removeAttribute(i.attributeName):i.type==="boolean"?s?this.setAttribute(i.attributeName,""):this.removeAttribute(i.attributeName):i.type==="object"?this.setAttribute(i.attributeName,JSON.stringify(s)):this.setAttribute(i.attributeName,String(s))},get(){const s=this.getAttribute(i.attributeName);return s===null&&i.defaultValue!==void 0?i.defaultValue:this.castFromAttribute(s,i.type)}})}addPropsReactions(e){const t=Object.entries(e).filter(([,r])=>Array.isArray(r.reactions)&&r.reactions.length);if(t.length===0)return;const i=r=>{const[a,h]=t.find(([,o])=>o.attributeName===r);h.reactions.forEach(o=>{typeof o=="function"?o.call(this,this[a]):typeof o=="string"&&o in this&&typeof this[o]=="function"?this[o](this[a]):console.error("unknown given reaction callback: ",o)})},s={attributes:!0,attributeFilter:t.map(([,r])=>r.attributeName),attributeOldValue:!0};new MutationObserver(r=>{for(const a of r){const h=a.oldValue;if(this.getAttribute(a.attributeName)===h)return;i(a.attributeName)}}).observe(this,s),t.filter(([,r])=>r.reactOnInit).forEach(([,r])=>i(r.attributeName))}checkForMissingAttributes(){const e=[];for(const t of Object.values(this.props))t.required&&!this.hasAttribute(t.attributeName)&&e.push(t.attributeName);e.length&&console.log(`${this.tagName.toLowerCase()} is missing required attribute(s): ${e.join(", ")}`)}castFromAttribute(e,t="string"){switch(t){case"boolean":return e!==null;case"number":return parseFloat(String(e));case"object":return JSON.parse(String(e));default:return e}}get state(){return I(this._state||{})}set state(e){throw new Error('The state should only be modified via the "setState" method.')}set initialStates(e){this._initialStates=e,this._state=e}get initialStates(){return this._initialStates||{}}setState(e,{merge:t=!0,silent:i=!1}={}){const s=this.state;if(this._state=Object.assign({},t?s:{},e),i||w(s,this._state))return this;const r=this.state,a=this.reactions||{};return Object.keys(a).forEach(h=>{if(h==="*")this.invokeReaction("*");else if(h in e){const o=O(s,h),c=O(r,h);w(o,c)||this.invokeReaction(h)}}),this}addReactions(e,t){if(typeof e=="object")Object.entries(e).forEach(([i,s])=>this.addReactions(i,s));else{this.reactions=this.reactions||{};const i=T(t),s=this.reactions[e]||[];this.reactions[e]=A(s,i,this.isNewReaction)}return this}isNewReaction(e,t){return!t.some(i=>e===i)}removeReactions(e,t){return typeof e=="object"?(Object.entries(e).forEach(([i,s])=>this.removeReactions(i,s)),this):(this.reactions.hasOwnProperty(e)?t?(t.forEach(i=>{this.reactions[e]=this.reactions[e].filter(s=>s!==i)}),this.reactions[e].length===0&&delete this.reactions[e]):delete this.reactions[e]:console.warn("no such prop found "),this)}invokeReaction(e){((this.reactions||{})[e]||new Set).forEach(t=>{typeof t=="function"?t(this.state):typeof t=="string"&&t in this&&typeof this[t]=="function"?this[t](this.state):console.error("given reaction callback can't be found: ",t)})}mergeEvents(e){this.events=this.events.filter(t=>this.isNewEvent(t,e)).concat(e)}isNewEvent(e,t){return!t.some(i=>i.event===e.event&&i.target===e.target)}getUiRoot(){return this.shadowRoot?this.shadowRoot:this}getEventTargets(e){let t=null;return t=e==="this"?this:e==="window"?window:this.ui[e],t}}export{x as A,L as M,B as N,q as O,F as R,H as S,$ as U,S as h,m as p,U as r};
//# sourceMappingURL=component.module.CfHwP-qy.js.map
